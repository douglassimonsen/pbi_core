{
  "$id": "https://developer.microsoft.com/json-schemas/fabric/verifiedAnswers/definition/9999.0.0/schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Definition",
  "description": "Defines the definition of a verified answer.",
  "type": "object",
  "properties": {
    "$schema": {
      "description": "Defines the schema to use for an item.",
      "type": "string"
    },
    "triggerPrompts": {
      "description": "List of prompts its related information that would trigger this verified answer.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/VerifiedAnswerTriggerPrompt"
      }
    },
    "contactObjectId": {
      "description": "AAD object id of the contact person or group.",
      "type": "string"
    },
    "sourceMetadata": {
      "description": "Metadata related to the source used as the answer.",
      "$ref": "#/definitions/VerifiedAnswerSourceMetadata"
    },
    "annotations": {
      "description": "Additional information to be saved (for example comments, readme, etc) for this page.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/Annotation"
      }
    }
  },
  "additionalProperties": false,
  "required": [
    "$schema",
    "contactObjectId",
    "triggerPrompts"
  ],
  "definitions": {
    "VerifiedAnswerTriggerPrompt": {
      "type": "object",
      "properties": {
        "prompt": {
          "description": "The text for the prompt.",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "prompt"
      ]
    },
    "VerifiedAnswerSourceMetadata": {
      "type": "object",
      "properties": {
        "visualMetadata": {
          "description": "Metadata related to the visual used as the source of the answer.",
          "$ref": "#/definitions/VisualSourceMetadata"
        }
      },
      "additionalProperties": false
    },
    "VisualSourceMetadata": {
      "type": "object",
      "properties": {
        "themeCollection": {
          "$ref": "#/definitions/ThemeCollection",
          "description": "Define a theme (built-in and/or a custom theme) to be used for this verified answer."
        },
        "publicCustomVisual": {
          "description": "Names of the custom visual (from AppSource) used for this verified answer.",
          "type": "string"
        },
        "resourcePackages": {
          "description": "Set of resources used within this verified answer.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ResourcePackage"
          }
        },
        "cache": {
          "description": "Cache information of the visual, will be updated by PowerBI when visual is rendered.",
          "type": "object",
          "additionalProperties": true
        }
      },
      "additionalProperties": false,
      "required": [
        "themeCollection"
      ]
    },
    "ThemeCollection": {
      "type": "object",
      "properties": {
        "baseTheme": {
          "description": "Defines the base monthly release themes shipped with Power BI.",
          "$ref": "#/definitions/ThemeMetadata"
        },
        "customTheme": {
          "description": "Defines a custom theme that is applied on top of the base theme.\nProperties not defined in the custom theme will fallback to using the base theme.",
          "$ref": "#/definitions/ThemeMetadata"
        }
      },
      "additionalProperties": false
    },
    "ThemeMetadata": {
      "type": "object",
      "properties": {
        "name": {
          "description": "Name of the theme.",
          "type": "string"
        },
        "reportVersionAtImport": {
          "$ref": "#/definitions/ThemeVersion",
          "description": "Versions when the theme was added to the report."
        },
        "type": {
          "$ref": "#/definitions/ThemeResourcePackageType",
          "description": "Built-in or user specific custom theme."
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "reportVersionAtImport",
        "type"
      ]
    },
    "ThemeVersion": {
      "type": "object",
      "properties": {
        "visual": {
          "description": "The max visual container version at import.",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "type": "string"
        },
        "page": {
          "description": "The max page version at import.",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "type": "string"
        },
        "report": {
          "description": "The max report version at import.",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "page",
        "report",
        "visual"
      ]
    },
    "ThemeResourcePackageType": {
      "type": "string",
      "enum": [
        "RegisteredResources",
        "SharedResources"
      ]
    },
    "ResourcePackage": {
      "type": "object",
      "properties": {
        "id": {
          "type": "number"
        },
        "name": {
          "type": "string"
        },
        "type": {
          "$ref": "#/definitions/ResourcePackageType"
        },
        "items": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ResourcePackageItem"
          }
        },
        "disabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "required": [
        "items",
        "name",
        "type"
      ]
    },
    "ResourcePackageType": {
      "type": "string",
      "enum": [
        "CustomVisual",
        "RegisteredResources",
        "SharedResources",
        "OrganizationalStoreCustomVisual"
      ]
    },
    "ResourcePackageItem": {
      "type": "object",
      "properties": {
        "id": {
          "type": "number"
        },
        "name": {
          "type": "string"
        },
        "path": {
          "type": "string"
        },
        "type": {
          "$ref": "#/definitions/ResourcePackageItemType"
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "path",
        "type"
      ]
    },
    "ResourcePackageItemType": {
      "type": "string",
      "enum": [
        "CustomVisualJavascript",
        "CustomVisualsCss",
        "CustomVisualScreenshot",
        "CustomVisualIcon",
        "CustomVisualWatermark",
        "CustomVisualMetadata",
        "Image",
        "ShapeMap",
        "CustomTheme",
        "BaseTheme",
        "DashboardTheme",
        "DashboardBaseTheme",
        "HighContrastTheme",
        "AppNavigation",
        "AppTheme",
        "AppBaseTheme"
      ]
    },
    "Annotation": {
      "type": "object",
      "properties": {
        "name": {
          "description": "Unique name for the annotation.",
          "type": "string"
        },
        "value": {
          "description": "A value for this annotation.",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "value"
      ]
    }
  }
}