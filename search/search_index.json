{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview of the PBI_CORE Library","text":"<p>The <code>pbi_core</code> library is designed to streamline and enhance the management, manipulation, and analysis of Power BI files (<code>.pbix</code>). It provides a suite of tools and utilities that enable users to automate repetitive tasks, extract insights, and perform advanced operations on Power BI files with ease. </p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Automation: Simplifies workflows by automating common tasks such as file conversion, tagging, and data extraction.</li> <li>Multi-language Support: Facilitates handling Power BI files in different languages, ensuring compatibility and ease of use across diverse locales.</li> <li>Data Analysis: Offers tools for analyzing and comparing data within Power BI files, enabling users to identify trends, discrepancies, and opportunities.</li> <li>File Management: Provides utilities for organizing, renaming, and categorizing Power BI files, making it easier to manage large collections.</li> <li>Integration: Supports integration with other data tools and platforms, enhancing the interoperability of Power BI files.</li> </ul>"},{"location":"#use-cases","title":"Use Cases","text":"<p>The <code>pbi_core</code> library is ideal for:</p> <ul> <li>Data analysts and business intelligence professionals who work extensively with Power BI files.</li> <li>Organizations managing large repositories of Power BI files and requiring efficient tools for organization and analysis.</li> <li>Developers looking to extend the functionality of Power BI through custom scripts and automation.</li> </ul>"},{"location":"SSAS/SSAS_ERD/","title":"SSAS ERD","text":"<pre><code>\nflowchart TD\n  attribute_hierarchy[Attribute Hierarchy]\n\n\n  column_permission[Column Permission]\n  column[Column]\n  culture[Culture]\n\n  expression[Expression]\n\n\n  group_by_column[Group By Column]\n  hierarchy[Hierarchy]\n  kpi[KPI]\n  level[Level]\n  linguistic_metadata[Linguistic Metadata]\n  measure[Measure]\n  model[Model]\n  partition[Partition]\n\n  query_group[Query Group]\n  relationship[Relationship]\n  role_membership[Role Membership]\n  role[Role]\n\n  table_permission[Table Permission]\n  table[Table]\n  variation[Variation]\n\n  level --&gt; attribute_hierarchy --&gt; column\n  relationship &amp; column_permission &amp; group_by_column --&gt; column --&gt; table\n  linguistic_metadata --&gt; culture --&gt; model\n  expression --&gt; query_group\n  level &amp; variation --&gt; hierarchy --&gt; table\n  kpi --&gt; measure --&gt; table --&gt; model\n  partition --&gt; table &amp; query_group\n  query_group --&gt; model\n  variation --&gt; relationship --&gt; table\n  role_membership --&gt; role --&gt; model\n  table_permission --&gt; table</code></pre>"},{"location":"SSAS/overview/","title":"Overview of SSAS and Power BI Integration","text":"<p>SSAS is the Query Engine behind Power BI. It is responsible for storing the data model, executing DAX queries, and returning the results to Power BI visuals. Each SSAS database also contains metadata tables about the data, measures, columns, tables, etc. in the data model. This metadata is used by Power BI to populate the Fields pane and to provide IntelliSense for DAX queries.</p>"},{"location":"SSAS/overview/#unmapped-tables","title":"Unmapped Tables","text":"<p>There are some metadata tables in SSAS that are not currently mapped in the pbi_core library. These tables are not commonly used in Power BI reports, but they may be useful for advanced scenarios. The following is a list of unmapped tables in SSAS. If you submit a <code>pbix</code> file that contains any of these tables, please open an issue on the pbi_core GitHub repository.</p> <p>Unmapped Tables: -   alternate_of[Alternate Of] -   annotations[Annotations] -   calculation_group[Calculation Group] -   calculation_item[Calculation Item] -   data_source[Data Source] -   detail_row_definition[Detail Row Definition] -   extended_property[Extended Property] -   format_string_definition[Format String Definition] -   object_translation[Object Translation] -   perspective_column[Perspective Column] -   perspective_hierarchy[Perspective Hierarchy] -   perspective_measure[Perspective Measure] -   perspective_set[Perspective Set] -   perspective_table[Perspective Table] -   perspective[Perspective] -   refresh_policy[Refresh Policy] -   related_column_detail[Related Column Detail] -   set[Set]</p>"},{"location":"SSAS/entities/alternate_of/","title":"Alternate Of","text":"<p>               Bases: <code>SsasReadonlyRecord</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/alternate_of.py</code> <pre><code>class AlternateOf(SsasReadonlyRecord):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n</code></pre>"},{"location":"SSAS/entities/annotation/","title":"Annotation","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/annotation.py</code> <pre><code>class Annotation(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/7a16a837-cb88-4cb2-a766-a97c4d0e1f43)\n    \"\"\"\n\n    object_id: int\n    object_type: ObjectType\n    name: str\n    value: str | None = None\n\n    modified_time: datetime.datetime\n\n    def object(self) -&gt; SsasTable:\n        \"\"\"Returns the object the annotation is describing.\n\n        Raises:\n            TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n        \"\"\"\n        mapper = {\n            ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies.find,\n            ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups.find,\n            ObjectType.COLUMN: self.tabular_model.columns.find,\n            ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions.find,\n            ObjectType.CULTURE: self.tabular_model.cultures.find,\n            ObjectType.DATASOURCE: self.tabular_model.data_sources.find,\n            ObjectType.EXPRESSION: self.tabular_model.expressions.find,\n            ObjectType.HIERARCHY: self.tabular_model.hierarchies.find,\n            ObjectType.KPI: self.tabular_model.kpis.find,\n            ObjectType.LEVEL: self.tabular_model.levels.find,\n            ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata.find,\n            ObjectType.MEASURE: self.tabular_model.measures.find,\n            ObjectType.MODEL: lambda _x: self.tabular_model.model,\n            ObjectType.PARTITION: self.tabular_model.partitions.find,\n            ObjectType.PERSPECTIVE: self.tabular_model.perspectives.find,\n            ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies.find,\n            ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures.find,\n            ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables.find,\n            ObjectType.QUERY_GROUP: self.tabular_model.query_groups.find,\n            ObjectType.RELATIONSHIP: self.tabular_model.relationships.find,\n            ObjectType.ROLE: self.tabular_model.roles.find,\n            ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships.find,\n            ObjectType.TABLE: self.tabular_model.tables.find,\n            ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions.find,\n            ObjectType.VARIATION: self.tabular_model.variations.find,\n        }\n        if self.object_type not in mapper:\n            msg = f\"Object Type {self.object_type} does not map to a known SSAS entity type.\"\n            raise TypeError(msg)\n        return mapper[self.object_type](self.object_id)\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        return LineageNode(self, lineage_type, [self.object().get_lineage(lineage_type)])\n\n    def __repr__(self) -&gt; str:\n        return f\"{self.__class__.__name__}({self.id}, on: {self.object()!r}, name: {self.name}, value: {self.value})\"\n</code></pre>"},{"location":"SSAS/entities/annotation/#pbi_core.ssas.model_tables.annotation.Annotation.object","title":"object","text":"<pre><code>object() -&gt; SsasTable\n</code></pre> <p>Returns the object the annotation is describing.</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>When the Object Type doesn't map to a know SSAS entity type</p> Source code in <code>pbi_core/ssas/model_tables/annotation.py</code> <pre><code>def object(self) -&gt; SsasTable:\n    \"\"\"Returns the object the annotation is describing.\n\n    Raises:\n        TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n    \"\"\"\n    mapper = {\n        ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies.find,\n        ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups.find,\n        ObjectType.COLUMN: self.tabular_model.columns.find,\n        ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions.find,\n        ObjectType.CULTURE: self.tabular_model.cultures.find,\n        ObjectType.DATASOURCE: self.tabular_model.data_sources.find,\n        ObjectType.EXPRESSION: self.tabular_model.expressions.find,\n        ObjectType.HIERARCHY: self.tabular_model.hierarchies.find,\n        ObjectType.KPI: self.tabular_model.kpis.find,\n        ObjectType.LEVEL: self.tabular_model.levels.find,\n        ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata.find,\n        ObjectType.MEASURE: self.tabular_model.measures.find,\n        ObjectType.MODEL: lambda _x: self.tabular_model.model,\n        ObjectType.PARTITION: self.tabular_model.partitions.find,\n        ObjectType.PERSPECTIVE: self.tabular_model.perspectives.find,\n        ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies.find,\n        ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures.find,\n        ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables.find,\n        ObjectType.QUERY_GROUP: self.tabular_model.query_groups.find,\n        ObjectType.RELATIONSHIP: self.tabular_model.relationships.find,\n        ObjectType.ROLE: self.tabular_model.roles.find,\n        ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships.find,\n        ObjectType.TABLE: self.tabular_model.tables.find,\n        ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions.find,\n        ObjectType.VARIATION: self.tabular_model.variations.find,\n    }\n    if self.object_type not in mapper:\n        msg = f\"Object Type {self.object_type} does not map to a known SSAS entity type.\"\n        raise TypeError(msg)\n    return mapper[self.object_type](self.object_id)\n</code></pre>"},{"location":"SSAS/entities/attribute_hierarchy/","title":"Attribute Hierarchy","text":"<p>               Bases: <code>SsasReadonlyRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/attribute_hierarchy.py</code> <pre><code>class AttributeHierarchy(SsasReadonlyRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/93d1844f-a6c7-4dda-879b-2e26ed5cd297)\n    \"\"\"\n\n    attribute_hierarchy_storage_id: int\n    column_id: int\n    state: DataState\n\n    modified_time: datetime.datetime\n    refreshed_time: datetime.datetime\n\n    def pbi_core_name(self) -&gt; str:\n        \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n        return self.column().pbi_core_name()\n\n    def column(self) -&gt; \"Column\":\n        return self.tabular_model.columns.find({\"id\": self.column_id})\n\n    def levels(self) -&gt; set[\"Level\"]:\n        return self.tabular_model.levels.find_all({\"hierarchy_id\": self.id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type, [level.get_lineage(lineage_type) for level in self.levels()])\n        return LineageNode(self, lineage_type, [self.column().get_lineage(lineage_type)])\n</code></pre>"},{"location":"SSAS/entities/attribute_hierarchy/#pbi_core.ssas.model_tables.attribute_hierarchy.AttributeHierarchy.pbi_core_name","title":"pbi_core_name","text":"<pre><code>pbi_core_name() -&gt; str\n</code></pre> <p>Returns the name displayed in the PBIX report.</p> Source code in <code>pbi_core/ssas/model_tables/attribute_hierarchy.py</code> <pre><code>def pbi_core_name(self) -&gt; str:\n    \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n    return self.column().pbi_core_name()\n</code></pre>"},{"location":"SSAS/entities/calc_dependency/","title":"Calc Dependency","text":"<p>               Bases: <code>SsasReadonlyRecord</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/calc_dependency.py</code> <pre><code>class CalcDependency(SsasReadonlyRecord):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n\n    database_name: str\n    object_type: str\n    table: str | None = None\n    object: str\n    expression: str | None = None\n    referenced_object_type: str\n    referenced_table: str | None = None\n    referenced_object: str\n    referenced_expression: str | None = None\n\n    def pbi_core_name(self) -&gt; str:\n        \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n        return f\"{self.object_type}[{self.object}] -&gt; {self.referenced_object_type}[{self.referenced_object}]\"\n</code></pre>"},{"location":"SSAS/entities/calc_dependency/#pbi_core.ssas.model_tables.calc_dependency.CalcDependency.pbi_core_name","title":"pbi_core_name","text":"<pre><code>pbi_core_name() -&gt; str\n</code></pre> <p>Returns the name displayed in the PBIX report.</p> Source code in <code>pbi_core/ssas/model_tables/calc_dependency.py</code> <pre><code>def pbi_core_name(self) -&gt; str:\n    \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n    return f\"{self.object_type}[{self.object}] -&gt; {self.referenced_object_type}[{self.referenced_object}]\"\n</code></pre>"},{"location":"SSAS/entities/calculation_group/","title":"Calculation Group","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/calculation_group.py</code> <pre><code>class CalculationGroup(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/ed9dcbcf-9910-455f-abc4-13c575157cfb)\n    \"\"\"\n\n    description: str\n    precedence: int\n    table_id: int\n\n    modified_time: datetime.datetime\n\n    def table(self) -&gt; \"Table\":\n        return self.tabular_model.tables.find(self.table_id)\n</code></pre>"},{"location":"SSAS/entities/calculation_item/","title":"Calculation Item","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/calculation_item.py</code> <pre><code>class CalculationItem(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/f5a398a7-ff65-45f0-a865-b561416f1cb4)\n    \"\"\"\n\n    calculation_group_id: int\n    description: str\n    error_message: str\n    expression: str\n    format_string_definition_id: int\n    name: str\n    ordinal: int\n    state: DataState\n\n    modified_time: datetime.datetime\n\n    def format_string_definition(self) -&gt; \"FormatStringDefinition\":\n        return self.tabular_model.format_string_definitions.find(self.format_string_definition_id)\n\n    def calculation_group(self) -&gt; \"CalculationGroup\":\n        return self.tabular_model.calculation_groups.find(self.calculation_group_id)\n</code></pre>"},{"location":"SSAS/entities/column/","title":"Column","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>A column of an SSAS table.</p> <p>PowerBI spec: Power BI</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>class Column(SsasRenameRecord):  # noqa: PLR0904\n    \"\"\"A column of an SSAS table.\n\n    PowerBI spec: [Power BI](https://learn.microsoft.com/en-us/analysis-services/tabular-models/column-properties-ssas-tabular?view=asallproducts-allversions)\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/00a9ec7a-5f4d-4517-8091-b370fe2dc18b)\n    \"\"\"\n\n    _field_mapping: ClassVar[dict[str, str]] = {\n        \"description\": \"Description\",\n    }\n    _db_name_field: str = \"ExplicitName\"\n    _read_only_fields = (\"table_id\",)\n\n    alignment: Alignment\n    attribute_hierarchy_id: int\n    column_origin_id: int | None = None\n    column_storage_id: int\n    data_category: str | None = None\n    description: str | None = None\n    display_folder: str | None = None\n    display_ordinal: int\n    encoding_hint: EncodingHint\n    error_message: str | None = None\n    explicit_data_type: DataType  # enum\n    explicit_name: str | None = None\n    expression: str | int | None = None\n    format_string: int | str | None = None\n    inferred_data_type: int  # enum\n    inferred_name: str | None = None\n    is_available_in_mdx: bool\n    is_default_image: bool\n    is_default_label: bool\n    is_hidden: bool\n    is_key: bool\n    is_nullable: bool\n    is_unique: bool\n    keep_unique_rows: bool\n    lineage_tag: UUID = uuid4()\n    sort_by_column_id: int | None = None\n    source_column: str | None = None\n    state: DataState\n    summarize_by: SummarizedBy\n    system_flags: int\n    table_id: int\n    table_detail_position: int\n    type: ColumnType\n\n    modified_time: datetime.datetime\n    refreshed_time: datetime.datetime\n    structure_modified_time: datetime.datetime\n\n    def expression_ast(self) -&gt; dax.Expression | None:\n        if not isinstance(self.expression, str):\n            return None\n        return dax.to_ast(self.expression)\n\n    def is_system_table(self) -&gt; bool:\n        return bool(self.system_flags &gt;&gt; 1 % 2)\n\n    def is_from_calculated_table(self) -&gt; bool:\n        return bool(self.system_flags % 2)\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            children_nodes: list[Column | Measure | AttributeHierarchy] = [\n                self.attribute_hierarchy(),\n                *self.child_measures(),\n                *self.sorting_columns(),\n                *self.child_columns(),\n            ]\n            children_lineage = [p.get_lineage(lineage_type) for p in children_nodes if p is not None]\n            return LineageNode(self, lineage_type, children_lineage)\n        parent_nodes: list[SsasTable | None] = [\n            self.table(),\n            self.sort_by_column(),\n            *self.parent_columns(),\n            *self.parent_measures(),\n        ]\n        parent_lineage = [p.get_lineage(lineage_type) for p in parent_nodes if p is not None]\n        return LineageNode(self, lineage_type, parent_lineage)\n\n    def data(self, head: int = 100) -&gt; list[int | float | str]:\n        table_name = self.table().name\n        ret = self.tabular_model.server.query_dax(\n            f\"EVALUATE TOPN({head}, SELECTCOLUMNS(ALL('{table_name}'), {self.full_name()}))\",\n            db_name=self.tabular_model.db_name,\n        )\n        return [next(iter(row.values())) for row in ret]\n\n    def full_name(self) -&gt; str:\n        \"\"\"Returns the fully qualified name for DAX queries.\"\"\"\n        table_name = self.table().name\n        return f\"'{table_name}'[{self.explicit_name}]\"\n\n    def pbi_core_name(self) -&gt; str:\n        \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n        if self.explicit_name is not None:\n            return self.explicit_name\n        if self.inferred_name is not None:\n            return self.inferred_name\n        return str(self.id)\n\n    def __repr__(self) -&gt; str:\n        return f\"Column({self.table().name}.{self.pbi_core_name()})\"\n\n    def table(self) -&gt; \"Table\":\n        \"\"\"Returns the table class the column is a part of.\"\"\"\n        return self.tabular_model.tables.find({\"id\": self.table_id})\n\n    def attribute_hierarchy(self) -&gt; \"AttributeHierarchy\":\n        return self.tabular_model.attribute_hierarchies.find({\"id\": self.attribute_hierarchy_id})\n\n    def levels(self) -&gt; set[\"Level\"]:\n        return self.tabular_model.levels.find_all({\"column_id\": self.id})\n\n    def _column_type(self) -&gt; Literal[\"COLUMN\", \"CALC_COLUMN\"]:\n        if self.type == ColumnType.Data:\n            return \"COLUMN\"\n        return \"CALC_COLUMN\"\n\n    def child_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n        \"\"\"Returns measures dependent on this Column.\"\"\"\n        object_type = self._column_type()\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"referenced_object_type\": object_type,\n            \"referenced_table\": self.table().name,\n            \"referenced_object\": self.explicit_name,\n            \"object_type\": \"MEASURE\",\n        })\n        child_keys: list[tuple[str | None, str]] = [(m.table, m.object) for m in dependent_measures]\n        full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in child_keys]\n\n        if recursive:\n            recursive_dependencies: set[Measure] = set()\n            for dep in full_dependencies:\n                if f\"[{self.explicit_name}]\" in str(dep.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.child_measures(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{self.explicit_name}]\" in str(x.expression)}\n\n    def parent_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n        \"\"\"Returns measures this column is dependent on.\n\n        Note:\n            Calculated columns can use Measures too :(.\n\n        \"\"\"\n        object_type = self._column_type()\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"object_type\": object_type,\n            \"table\": self.table().name,\n            \"object\": self.explicit_name,\n            \"referenced_object_type\": \"MEASURE\",\n        })\n        parent_keys = [(m.referenced_table, m.referenced_object) for m in dependent_measures]\n        full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in parent_keys]\n\n        if recursive:\n            recursive_dependencies: set[Measure] = set()\n            for dep in full_dependencies:\n                if f\"[{dep.name}]\" in str(self.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.parent_measures(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{x.name}]\" in str(self.expression)}\n\n    def child_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n        \"\"\"Returns columns dependent on this Column.\n\n        Note:\n            Only occurs when the dependent column is calculated (expression is not None).\n\n        \"\"\"\n        object_type = self._column_type()\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"referenced_object_type\": object_type,\n            \"referenced_table\": self.table().name,\n            \"referenced_object\": self.explicit_name,\n        })\n        assert all(m.table is not None for m in dependent_measures)\n        child_keys: list[tuple[str, str]] = [  # pyright: ignore reportAssignmentType\n            (m.table, m.object) for m in dependent_measures if m.object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n        ]\n        full_dependencies = [m for m in self.tabular_model.columns if (m.table().name, m.explicit_name) in child_keys]\n\n        if recursive:\n            recursive_dependencies: set[Column] = set()\n            for dep in full_dependencies:\n                if f\"[{self.explicit_name}]\" in str(dep.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.child_columns(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{self.explicit_name}]\" in str(x.expression)}\n\n    def parent_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n        \"\"\"Returns Columns this Column is dependent on.\n\n        Note:\n            Parent columns are non-empty only when the column is calculated.\n            Columns defined by a PowerQuery import or DirectQuery do not have parent columns.\n\n        \"\"\"\n        object_type = self._column_type()\n        if object_type == \"COLUMN\":\n            return set()\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"object_type\": object_type,\n            \"table\": self.table().name,\n            \"object\": self.explicit_name,\n        })\n        parent_keys = {\n            (m.referenced_table, m.referenced_object)\n            for m in dependent_measures\n            if m.referenced_object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n        }\n        full_dependencies = [c for c in self.tabular_model.columns if (c.table().name, c.explicit_name) in parent_keys]\n\n        if recursive:\n            recursive_dependencies: set[Column] = set()\n            for dep in full_dependencies:\n                if f\"[{dep.explicit_name}]\" in str(self.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.parent_columns(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{x.explicit_name}]\" in str(self.expression)}\n\n    def parents(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n        \"\"\"Returns all columns and measures this Column is dependent on.\"\"\"\n        full_dependencies = self.parent_columns() | self.parent_measures()\n        if recursive:\n            recursive_dependencies: set[Column | Measure] = set()\n            for dep in full_dependencies:\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parents(recursive=True))\n            return recursive_dependencies\n\n        return full_dependencies\n\n    def children(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n        \"\"\"Returns all columns and measures dependent on this Column.\"\"\"\n        full_dependencies = self.child_columns() | self.child_measures()\n        if recursive:\n            recursive_dependencies: set[Column | Measure] = set()\n            for dep in full_dependencies:\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.children(recursive=True))\n            return recursive_dependencies\n        return full_dependencies\n\n    def sort_by_column(self) -&gt; \"Column | None\":\n        if self.sort_by_column_id is None:\n            return None\n        return self.tabular_model.columns.find({\"id\": self.sort_by_column_id})\n\n    def sorting_columns(self) -&gt; set[\"Column\"]:\n        \"\"\"Provides the inverse information of sort_by_column.\"\"\"\n        return self.tabular_model.columns.find_all({\"sort_by_column_id\": self.id})\n\n    def from_relationships(self) -&gt; set[\"Relationship\"]:\n        return self.tabular_model.relationships.find_all({\"from_column_id\": self.id})\n\n    def to_relationships(self) -&gt; set[\"Relationship\"]:\n        return self.tabular_model.relationships.find_all({\"to_column_id\": self.id})\n\n    def relationships(self) -&gt; set[\"Relationship\"]:\n        return self.from_relationships() | self.to_relationships()\n\n    def delete(  # pyright: ignore reportIncompatibleMethodOverride\n        self,\n        *,\n        remote_from_partition_query: bool = False,\n    ) -&gt; list[BeautifulSoup] | None:\n        \"\"\"Removes column from the SSAS model.\n\n        Args:\n            remote_from_partition_query (bool): If this is True, updates the PowerQuery to drop the column so it doesn't repopulate on data refresh. If the column is calculated (meaning it is not part of the PowerQuery), an info record is logged and nothing else happens.\n\n        \"\"\"  # noqa: E501\n        rets: list[BeautifulSoup] = []\n        if remote_from_partition_query:\n            if self._column_type() == \"CALC_COLUMN\":\n                logger.info(\"Column is calculated, there is nothing to remove from the PowerQuery\", column=self)\n                return None\n            name = self.explicit_name\n            if name is None:\n                logger.warning(\"Column has no name to include in the PowerQuery\", column=self)\n                return None\n            rets.extend(partition.remove_columns([name]) for partition in self.table().partitions())\n        rets.append(super().delete())\n        return rets\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.child_columns","title":"child_columns","text":"<pre><code>child_columns(*, recursive: bool = False) -&gt; set[Column]\n</code></pre> <p>Returns columns dependent on this Column.</p> Note <p>Only occurs when the dependent column is calculated (expression is not None).</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def child_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n    \"\"\"Returns columns dependent on this Column.\n\n    Note:\n        Only occurs when the dependent column is calculated (expression is not None).\n\n    \"\"\"\n    object_type = self._column_type()\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"referenced_object_type\": object_type,\n        \"referenced_table\": self.table().name,\n        \"referenced_object\": self.explicit_name,\n    })\n    assert all(m.table is not None for m in dependent_measures)\n    child_keys: list[tuple[str, str]] = [  # pyright: ignore reportAssignmentType\n        (m.table, m.object) for m in dependent_measures if m.object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n    ]\n    full_dependencies = [m for m in self.tabular_model.columns if (m.table().name, m.explicit_name) in child_keys]\n\n    if recursive:\n        recursive_dependencies: set[Column] = set()\n        for dep in full_dependencies:\n            if f\"[{self.explicit_name}]\" in str(dep.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.child_columns(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{self.explicit_name}]\" in str(x.expression)}\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.child_measures","title":"child_measures","text":"<pre><code>child_measures(*, recursive: bool = False) -&gt; set[Measure]\n</code></pre> <p>Returns measures dependent on this Column.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def child_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n    \"\"\"Returns measures dependent on this Column.\"\"\"\n    object_type = self._column_type()\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"referenced_object_type\": object_type,\n        \"referenced_table\": self.table().name,\n        \"referenced_object\": self.explicit_name,\n        \"object_type\": \"MEASURE\",\n    })\n    child_keys: list[tuple[str | None, str]] = [(m.table, m.object) for m in dependent_measures]\n    full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in child_keys]\n\n    if recursive:\n        recursive_dependencies: set[Measure] = set()\n        for dep in full_dependencies:\n            if f\"[{self.explicit_name}]\" in str(dep.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.child_measures(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{self.explicit_name}]\" in str(x.expression)}\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.children","title":"children","text":"<pre><code>children(*, recursive: bool = False) -&gt; set[Column | Measure]\n</code></pre> <p>Returns all columns and measures dependent on this Column.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def children(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n    \"\"\"Returns all columns and measures dependent on this Column.\"\"\"\n    full_dependencies = self.child_columns() | self.child_measures()\n    if recursive:\n        recursive_dependencies: set[Column | Measure] = set()\n        for dep in full_dependencies:\n            recursive_dependencies.add(dep)\n            recursive_dependencies.update(dep.children(recursive=True))\n        return recursive_dependencies\n    return full_dependencies\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.delete","title":"delete","text":"<pre><code>delete(*, remote_from_partition_query: bool = False) -&gt; list[BeautifulSoup] | None\n</code></pre> <p>Removes column from the SSAS model.</p> <p>Parameters:</p> Name Type Description Default <code>remote_from_partition_query</code> <code>bool</code> <p>If this is True, updates the PowerQuery to drop the column so it doesn't repopulate on data refresh. If the column is calculated (meaning it is not part of the PowerQuery), an info record is logged and nothing else happens.</p> <code>False</code> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def delete(  # pyright: ignore reportIncompatibleMethodOverride\n    self,\n    *,\n    remote_from_partition_query: bool = False,\n) -&gt; list[BeautifulSoup] | None:\n    \"\"\"Removes column from the SSAS model.\n\n    Args:\n        remote_from_partition_query (bool): If this is True, updates the PowerQuery to drop the column so it doesn't repopulate on data refresh. If the column is calculated (meaning it is not part of the PowerQuery), an info record is logged and nothing else happens.\n\n    \"\"\"  # noqa: E501\n    rets: list[BeautifulSoup] = []\n    if remote_from_partition_query:\n        if self._column_type() == \"CALC_COLUMN\":\n            logger.info(\"Column is calculated, there is nothing to remove from the PowerQuery\", column=self)\n            return None\n        name = self.explicit_name\n        if name is None:\n            logger.warning(\"Column has no name to include in the PowerQuery\", column=self)\n            return None\n        rets.extend(partition.remove_columns([name]) for partition in self.table().partitions())\n    rets.append(super().delete())\n    return rets\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.full_name","title":"full_name","text":"<pre><code>full_name() -&gt; str\n</code></pre> <p>Returns the fully qualified name for DAX queries.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def full_name(self) -&gt; str:\n    \"\"\"Returns the fully qualified name for DAX queries.\"\"\"\n    table_name = self.table().name\n    return f\"'{table_name}'[{self.explicit_name}]\"\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.parent_columns","title":"parent_columns","text":"<pre><code>parent_columns(*, recursive: bool = False) -&gt; set[Column]\n</code></pre> <p>Returns Columns this Column is dependent on.</p> Note <p>Parent columns are non-empty only when the column is calculated. Columns defined by a PowerQuery import or DirectQuery do not have parent columns.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def parent_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n    \"\"\"Returns Columns this Column is dependent on.\n\n    Note:\n        Parent columns are non-empty only when the column is calculated.\n        Columns defined by a PowerQuery import or DirectQuery do not have parent columns.\n\n    \"\"\"\n    object_type = self._column_type()\n    if object_type == \"COLUMN\":\n        return set()\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"object_type\": object_type,\n        \"table\": self.table().name,\n        \"object\": self.explicit_name,\n    })\n    parent_keys = {\n        (m.referenced_table, m.referenced_object)\n        for m in dependent_measures\n        if m.referenced_object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n    }\n    full_dependencies = [c for c in self.tabular_model.columns if (c.table().name, c.explicit_name) in parent_keys]\n\n    if recursive:\n        recursive_dependencies: set[Column] = set()\n        for dep in full_dependencies:\n            if f\"[{dep.explicit_name}]\" in str(self.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parent_columns(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{x.explicit_name}]\" in str(self.expression)}\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.parent_measures","title":"parent_measures","text":"<pre><code>parent_measures(*, recursive: bool = False) -&gt; set[Measure]\n</code></pre> <p>Returns measures this column is dependent on.</p> Note <p>Calculated columns can use Measures too :(.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def parent_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n    \"\"\"Returns measures this column is dependent on.\n\n    Note:\n        Calculated columns can use Measures too :(.\n\n    \"\"\"\n    object_type = self._column_type()\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"object_type\": object_type,\n        \"table\": self.table().name,\n        \"object\": self.explicit_name,\n        \"referenced_object_type\": \"MEASURE\",\n    })\n    parent_keys = [(m.referenced_table, m.referenced_object) for m in dependent_measures]\n    full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in parent_keys]\n\n    if recursive:\n        recursive_dependencies: set[Measure] = set()\n        for dep in full_dependencies:\n            if f\"[{dep.name}]\" in str(self.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parent_measures(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{x.name}]\" in str(self.expression)}\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.parents","title":"parents","text":"<pre><code>parents(*, recursive: bool = False) -&gt; set[Column | Measure]\n</code></pre> <p>Returns all columns and measures this Column is dependent on.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def parents(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n    \"\"\"Returns all columns and measures this Column is dependent on.\"\"\"\n    full_dependencies = self.parent_columns() | self.parent_measures()\n    if recursive:\n        recursive_dependencies: set[Column | Measure] = set()\n        for dep in full_dependencies:\n            recursive_dependencies.add(dep)\n            recursive_dependencies.update(dep.parents(recursive=True))\n        return recursive_dependencies\n\n    return full_dependencies\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.pbi_core_name","title":"pbi_core_name","text":"<pre><code>pbi_core_name() -&gt; str\n</code></pre> <p>Returns the name displayed in the PBIX report.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def pbi_core_name(self) -&gt; str:\n    \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n    if self.explicit_name is not None:\n        return self.explicit_name\n    if self.inferred_name is not None:\n        return self.inferred_name\n    return str(self.id)\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.sorting_columns","title":"sorting_columns","text":"<pre><code>sorting_columns() -&gt; set[Column]\n</code></pre> <p>Provides the inverse information of sort_by_column.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def sorting_columns(self) -&gt; set[\"Column\"]:\n    \"\"\"Provides the inverse information of sort_by_column.\"\"\"\n    return self.tabular_model.columns.find_all({\"sort_by_column_id\": self.id})\n</code></pre>"},{"location":"SSAS/entities/column/#pbi_core.ssas.model_tables.column.Column.table","title":"table","text":"<pre><code>table() -&gt; Table\n</code></pre> <p>Returns the table class the column is a part of.</p> Source code in <code>pbi_core/ssas/model_tables/column/column.py</code> <pre><code>def table(self) -&gt; \"Table\":\n    \"\"\"Returns the table class the column is a part of.\"\"\"\n    return self.tabular_model.tables.find({\"id\": self.table_id})\n</code></pre>"},{"location":"SSAS/entities/column_permission/","title":"Column Permission","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/column_permission.py</code> <pre><code>class ColumnPermission(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/10566cbb-390d-470d-b0ff-fc2713277031)\n    \"\"\"\n\n    column_id: int\n    metadata_permission: MetadataPermission\n    table_permission_id: int\n\n    modified_time: datetime.datetime\n\n    def table_permission(self) -&gt; TablePermission:\n        return self.tabular_model.table_permissions.find(self.table_permission_id)\n\n    def column(self) -&gt; \"Column\":\n        return self.tabular_model.columns.find(self.column_id)\n</code></pre>"},{"location":"SSAS/entities/culture/","title":"Culture","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/culture.py</code> <pre><code>class Culture(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/d3770118-47bf-4304-9edf-8025f4820c45)\n    \"\"\"\n\n    linguistic_metadata_id: int\n    model_id: int\n    name: str\n\n    modified_time: datetime.datetime\n    structure_modified_time: datetime.datetime\n\n    def linguistic_metdata(self) -&gt; \"LinguisticMetadata\":\n        return self.tabular_model.linguistic_metadata.find({\"id\": self.linguistic_metadata_id})\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type, [self.linguistic_metdata().get_lineage(lineage_type)])\n        return LineageNode(self, lineage_type, [self.model().get_lineage(lineage_type)])\n</code></pre>"},{"location":"SSAS/entities/data_source/","title":"Data Source","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/data_source.py</code> <pre><code>class DataSource(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/ee12dcb7-096e-4e4e-99a4-47caeb9390f5)\n    \"\"\"\n\n    account: str | None = None\n    connection_string: str\n    context_expression: str | None = None\n    credential: str | None = None\n    description: str | None = None\n    impersonation_mode: ImpersonationMode\n    isolation: Isolation\n    max_connections: int\n    model_id: int\n    name: str\n    options: str | None = None\n    password: str | None = None\n    provider: str | None = None\n    timeout: int\n    type: DataSourceType\n\n    modified_time: datetime.datetime\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n</code></pre>"},{"location":"SSAS/entities/detail_row_definition/","title":"Detail Row Definition","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Note <p>Additional details can be found here: SQLBI</p> Source code in <code>pbi_core/ssas/model_tables/detail_row_definition.py</code> <pre><code>class DetailRowDefinition(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/7eb1e044-4eed-467d-b10f-ce208798ddb0)\n\n    Note:\n        Additional details can be found here: [SQLBI](https://www.sqlbi.com/articles/controlling-drillthrough-in-excel-pivottables-connected-to-power-bi-or-analysis-services/)\n\n    \"\"\"\n\n    error_message: str\n    expression: str\n    object_id: int\n    object_type: ObjectType\n    state: DataState\n\n    modified_time: datetime.datetime\n\n    @classmethod\n    def _db_type_name(cls) -&gt; str:\n        return \"DetailRowsDefinition\"\n\n    def object(self) -&gt; \"Table | Measure\":\n        match self.object_type:\n            case ObjectType.MEASURE:\n                return self.tabular_model.measures.find(self.object_id)\n            case ObjectType.TABLE:\n                return self.tabular_model.tables.find(self.object_id)\n            case _:\n                msg = f\"No logic for object type: {self.object_type}\"\n                raise TypeError(msg)\n</code></pre>"},{"location":"SSAS/entities/expression/","title":"Expression","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/expression.py</code> <pre><code>class Expression(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/61f98e45-d5e3-4435-b829-2f2f043839c1)\n    \"\"\"\n\n    description: str | None = None\n    expression: str\n    kind: Kind\n    model_id: int\n    name: str\n    parameter_values_column_id: int | None = None\n    query_group_id: int | None = None\n\n    lineage_tag: UUID = uuid4()\n    source_lineage_tag: UUID = uuid4()\n\n    modified_time: datetime.datetime\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n\n    def parameter_values_column(self) -&gt; \"Column | None\":\n        if self.parameter_values_column_id is None:\n            return None\n        return self.tabular_model.columns.find(self.parameter_values_column_id)\n\n    def query_group(self) -&gt; \"QueryGroup | None\":\n        return self.tabular_model.query_groups.find({\"id\": self.query_group_id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        parent_nodes: list[SsasTable | None] = [self.model(), self.query_group()]\n        parent_lineage = [p.get_lineage(lineage_type) for p in parent_nodes if p is not None]\n        return LineageNode(self, lineage_type, parent_lineage)\n</code></pre>"},{"location":"SSAS/entities/extended_property/","title":"Extended Property","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/extended_property.py</code> <pre><code>class ExtendedProperty(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/5c1521e5-defe-4ba2-9558-b67457e94569)\n    \"\"\"\n\n    object_id: int\n    object_type: ObjectType\n    name: str\n    type: ObjectType\n    value: Json[ExtendedPropertyValue]\n\n    modified_time: datetime.datetime\n\n    def object(self) -&gt; \"SsasTable\":\n        \"\"\"Returns the object the property is describing.\"\"\"\n        mapper: dict[ObjectType, SsasTable] = {\n            ObjectType.MODEL: self.tabular_model.model,\n            ObjectType.DATASOURCE: self.tabular_model.data_sources.find(self.object_id),\n            ObjectType.TABLE: self.tabular_model.tables.find(self.object_id),\n            ObjectType.COLUMN: self.tabular_model.columns.find(self.object_id),\n            ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies.find(self.object_id),\n            ObjectType.PARTITION: self.tabular_model.partitions.find(self.object_id),\n            ObjectType.RELATIONSHIP: self.tabular_model.relationships.find(self.object_id),\n            ObjectType.MEASURE: self.tabular_model.measures.find(self.object_id),\n            ObjectType.HIERARCHY: self.tabular_model.hierarchies.find(self.object_id),\n            ObjectType.LEVEL: self.tabular_model.levels.find(self.object_id),\n            ObjectType.KPI: self.tabular_model.kpis.find(self.object_id),\n            ObjectType.CULTURE: self.tabular_model.cultures.find(self.object_id),\n            ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata.find(self.object_id),\n            ObjectType.PERSPECTIVE: self.tabular_model.perspectives.find(self.object_id),\n            ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables.find(self.object_id),\n            ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies.find(self.object_id),\n            ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures.find(self.object_id),\n            ObjectType.ROLE: self.tabular_model.roles.find(self.object_id),\n            ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships.find(self.object_id),\n            ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions.find(self.object_id),\n            ObjectType.VARIATION: self.tabular_model.variations.find(self.object_id),\n            ObjectType.EXPRESSION: self.tabular_model.expressions.find(self.object_id),\n            ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions.find(self.object_id),\n            ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups.find(self.object_id),\n            ObjectType.QUERY_GROUP: self.tabular_model.query_groups.find(self.object_id),\n        }\n        return mapper[self.object_type]\n\n    @classmethod\n    def _db_command_obj_name(cls) -&gt; str:\n        return \"ExtendedProperties\"\n</code></pre>"},{"location":"SSAS/entities/extended_property/#pbi_core.ssas.model_tables.extended_property.ExtendedProperty.object","title":"object","text":"<pre><code>object() -&gt; SsasTable\n</code></pre> <p>Returns the object the property is describing.</p> Source code in <code>pbi_core/ssas/model_tables/extended_property.py</code> <pre><code>def object(self) -&gt; \"SsasTable\":\n    \"\"\"Returns the object the property is describing.\"\"\"\n    mapper: dict[ObjectType, SsasTable] = {\n        ObjectType.MODEL: self.tabular_model.model,\n        ObjectType.DATASOURCE: self.tabular_model.data_sources.find(self.object_id),\n        ObjectType.TABLE: self.tabular_model.tables.find(self.object_id),\n        ObjectType.COLUMN: self.tabular_model.columns.find(self.object_id),\n        ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies.find(self.object_id),\n        ObjectType.PARTITION: self.tabular_model.partitions.find(self.object_id),\n        ObjectType.RELATIONSHIP: self.tabular_model.relationships.find(self.object_id),\n        ObjectType.MEASURE: self.tabular_model.measures.find(self.object_id),\n        ObjectType.HIERARCHY: self.tabular_model.hierarchies.find(self.object_id),\n        ObjectType.LEVEL: self.tabular_model.levels.find(self.object_id),\n        ObjectType.KPI: self.tabular_model.kpis.find(self.object_id),\n        ObjectType.CULTURE: self.tabular_model.cultures.find(self.object_id),\n        ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata.find(self.object_id),\n        ObjectType.PERSPECTIVE: self.tabular_model.perspectives.find(self.object_id),\n        ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables.find(self.object_id),\n        ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies.find(self.object_id),\n        ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures.find(self.object_id),\n        ObjectType.ROLE: self.tabular_model.roles.find(self.object_id),\n        ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships.find(self.object_id),\n        ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions.find(self.object_id),\n        ObjectType.VARIATION: self.tabular_model.variations.find(self.object_id),\n        ObjectType.EXPRESSION: self.tabular_model.expressions.find(self.object_id),\n        ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions.find(self.object_id),\n        ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups.find(self.object_id),\n        ObjectType.QUERY_GROUP: self.tabular_model.query_groups.find(self.object_id),\n    }\n    return mapper[self.object_type]\n</code></pre>"},{"location":"SSAS/entities/format_string_definition/","title":"Format String Definition","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/format_string_definition.py</code> <pre><code>class FormatStringDefinition(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/b756b0c1-c912-4218-80dc-7ff09d0968ff)\n    \"\"\"\n\n    object_type: ObjectType\n    object_id: int\n    error_message: str | None = None\n    \"\"\"When no issue exists, this field is blank\"\"\"\n    expression: str\n    \"\"\"The DAX expression defining the \"\"\"\n    state: DataState\n\n    modified_time: datetime.datetime\n\n    def pbi_core_name(self) -&gt; str:\n        return str(self.object_id)\n\n    def object(self) -&gt; SsasTable:\n        \"\"\"Returns the object the annotation is describing.\n\n        Raises:\n            TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n        \"\"\"\n        if self.object_type == ObjectType.MODEL:\n            return self.tabular_model.model\n\n        type_mapper: dict[ObjectType, Group] = {\n            ObjectType.DATASOURCE: self.tabular_model.data_sources,\n            ObjectType.TABLE: self.tabular_model.tables,\n            ObjectType.COLUMN: self.tabular_model.columns,\n            ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies,\n            ObjectType.PARTITION: self.tabular_model.partitions,\n            ObjectType.RELATIONSHIP: self.tabular_model.relationships,\n            ObjectType.MEASURE: self.tabular_model.measures,\n            ObjectType.HIERARCHY: self.tabular_model.hierarchies,\n            ObjectType.LEVEL: self.tabular_model.levels,\n            ObjectType.KPI: self.tabular_model.kpis,\n            ObjectType.CULTURE: self.tabular_model.cultures,\n            ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata,\n            ObjectType.PERSPECTIVE: self.tabular_model.perspectives,\n            ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables,\n            ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies,\n            ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures,\n            ObjectType.ROLE: self.tabular_model.roles,\n            ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships,\n            ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions,\n            ObjectType.VARIATION: self.tabular_model.variations,\n            ObjectType.EXPRESSION: self.tabular_model.expressions,\n            ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions,\n            ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups,\n            ObjectType.QUERY_GROUP: self.tabular_model.query_groups,\n        }\n        if self.object_type not in type_mapper:\n            msg = f\"Object Type {self.object_type} does not map to a known SSAS entity type.\"\n            raise TypeError(msg)\n\n        return type_mapper[self.object_type].find(self.object_id)\n\n    def expression_ast(self) -&gt; dax.Expression | None:\n        if not isinstance(self.expression, str):\n            return None\n        ret = dax.to_ast(self.expression)\n        if ret is None:\n            msg = \"Failed to parse DAX expression from format string definition\"\n            raise ValueError(msg)\n        return ret\n\n    def __repr__(self) -&gt; str:\n        return f\"{self.__class__.__name__}({self.id}, on: {self.object()!r})\"\n</code></pre>"},{"location":"SSAS/entities/format_string_definition/#pbi_core.ssas.model_tables.format_string_definition.FormatStringDefinition.error_message","title":"error_message  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>error_message: str | None = None\n</code></pre> <p>When no issue exists, this field is blank</p>"},{"location":"SSAS/entities/format_string_definition/#pbi_core.ssas.model_tables.format_string_definition.FormatStringDefinition.expression","title":"expression  <code>instance-attribute</code>","text":"<pre><code>expression: str\n</code></pre> <p>The DAX expression defining the</p>"},{"location":"SSAS/entities/format_string_definition/#pbi_core.ssas.model_tables.format_string_definition.FormatStringDefinition.object","title":"object","text":"<pre><code>object() -&gt; SsasTable\n</code></pre> <p>Returns the object the annotation is describing.</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>When the Object Type doesn't map to a know SSAS entity type</p> Source code in <code>pbi_core/ssas/model_tables/format_string_definition.py</code> <pre><code>def object(self) -&gt; SsasTable:\n    \"\"\"Returns the object the annotation is describing.\n\n    Raises:\n        TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n    \"\"\"\n    if self.object_type == ObjectType.MODEL:\n        return self.tabular_model.model\n\n    type_mapper: dict[ObjectType, Group] = {\n        ObjectType.DATASOURCE: self.tabular_model.data_sources,\n        ObjectType.TABLE: self.tabular_model.tables,\n        ObjectType.COLUMN: self.tabular_model.columns,\n        ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies,\n        ObjectType.PARTITION: self.tabular_model.partitions,\n        ObjectType.RELATIONSHIP: self.tabular_model.relationships,\n        ObjectType.MEASURE: self.tabular_model.measures,\n        ObjectType.HIERARCHY: self.tabular_model.hierarchies,\n        ObjectType.LEVEL: self.tabular_model.levels,\n        ObjectType.KPI: self.tabular_model.kpis,\n        ObjectType.CULTURE: self.tabular_model.cultures,\n        ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata,\n        ObjectType.PERSPECTIVE: self.tabular_model.perspectives,\n        ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables,\n        ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies,\n        ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures,\n        ObjectType.ROLE: self.tabular_model.roles,\n        ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships,\n        ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions,\n        ObjectType.VARIATION: self.tabular_model.variations,\n        ObjectType.EXPRESSION: self.tabular_model.expressions,\n        ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions,\n        ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups,\n        ObjectType.QUERY_GROUP: self.tabular_model.query_groups,\n    }\n    if self.object_type not in type_mapper:\n        msg = f\"Object Type {self.object_type} does not map to a known SSAS entity type.\"\n        raise TypeError(msg)\n\n    return type_mapper[self.object_type].find(self.object_id)\n</code></pre>"},{"location":"SSAS/entities/group_by_column/","title":"Group By Column","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/group_by_column.py</code> <pre><code>class GroupByColumn(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n</code></pre>"},{"location":"SSAS/entities/hierarchy/","title":"Hierarchy","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/hierarchy.py</code> <pre><code>class Hierarchy(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/4eff6661-1458-4c5a-9875-07218f1458e5)\n    \"\"\"\n\n    description: str | None = None\n    display_folder: str | None = None\n    hide_members: HideMembers\n    hierarchy_storage_id: int\n    is_hidden: bool\n    name: str\n    state: DataState\n    table_id: int\n    \"\"\"A foreign key to the Table object the hierarchy is stored under\"\"\"\n\n    lineage_tag: UUID = uuid4()\n    source_lineage_tag: UUID = uuid4()\n\n    modified_time: datetime.datetime\n    refreshed_time: datetime.datetime\n    \"\"\"The last time the sources for this hierarchy were refreshed\"\"\"\n    structure_modified_time: datetime.datetime\n\n    def table(self) -&gt; \"Table\":\n        return self.tabular_model.tables.find({\"id\": self.table_id})\n\n    def levels(self) -&gt; set[\"Level\"]:\n        return self.tabular_model.levels.find_all({\"hierarchy_id\": self.id})\n\n    def variations(self) -&gt; set[\"Variation\"]:\n        return self.tabular_model.variations.find_all({\"default_hierarchy_id\": self.id})\n\n    @classmethod\n    def _db_command_obj_name(cls) -&gt; str:\n        return \"Hierarchies\"\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [level.get_lineage(lineage_type) for level in self.levels()]\n                + [variation.get_lineage(lineage_type) for variation in self.variations()],\n            )\n\n        return LineageNode(\n            self,\n            lineage_type,\n            [\n                self.table().get_lineage(lineage_type),\n            ],\n        )\n</code></pre>"},{"location":"SSAS/entities/hierarchy/#pbi_core.ssas.model_tables.hierarchy.Hierarchy.refreshed_time","title":"refreshed_time  <code>instance-attribute</code>","text":"<pre><code>refreshed_time: datetime\n</code></pre> <p>The last time the sources for this hierarchy were refreshed</p>"},{"location":"SSAS/entities/hierarchy/#pbi_core.ssas.model_tables.hierarchy.Hierarchy.table_id","title":"table_id  <code>instance-attribute</code>","text":"<pre><code>table_id: int\n</code></pre> <p>A foreign key to the Table object the hierarchy is stored under</p>"},{"location":"SSAS/entities/kpi/","title":"KPI","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/kpi.py</code> <pre><code>class KPI(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/1289ceca-8113-4019-8f90-8132a91117cf)\n    \"\"\"\n\n    description: str | None = None\n    measure_id: int\n    status_description: str | None = None\n    status_expression: str\n    status_graphic: str\n    target_description: str | None = None\n    target_expression: str\n    target_format_string: str\n    trend_description: str | None = None\n    trend_expression: str | None = None\n\n    modified_time: datetime.datetime\n\n    def pbi_core_name(self) -&gt; str:\n        \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n        return self.measure().pbi_core_name()\n\n    def measure(self) -&gt; \"Measure\":\n        return self.tabular_model.measures.find({\"id\": self.measure_id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        return LineageNode(self, lineage_type, [self.measure().get_lineage(lineage_type)])\n\n    @classmethod\n    def _db_command_obj_name(cls) -&gt; str:\n        return \"Kpis\"\n</code></pre>"},{"location":"SSAS/entities/kpi/#pbi_core.ssas.model_tables.kpi.KPI.pbi_core_name","title":"pbi_core_name","text":"<pre><code>pbi_core_name() -&gt; str\n</code></pre> <p>Returns the name displayed in the PBIX report.</p> Source code in <code>pbi_core/ssas/model_tables/kpi.py</code> <pre><code>def pbi_core_name(self) -&gt; str:\n    \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n    return self.measure().pbi_core_name()\n</code></pre>"},{"location":"SSAS/entities/level/","title":"Level","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>A level in a hierarchy. For example, in a hierarchy of \"Date\", the levels could be \"Year\", \"Month\", and \"Day\".</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/level.py</code> <pre><code>class Level(SsasRenameRecord):\n    \"\"\"A level in a hierarchy. For example, in a hierarchy of \"Date\", the levels could be \"Year\", \"Month\", and \"Day\".\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/a010d75e-3b68-4825-898f-62fdeab4557f)\n    \"\"\"\n\n    column_id: int\n    description: str | None = None\n    \"\"\"A description of the level, which may be used in the hover tooltip in edit mode\"\"\"\n    hierarchy_id: int\n    name: str\n    \"\"\"The name of the level, e.g. \"Year\", \"Quarter\", \"Month\", \"Day\" in a Date hierarchy.\"\"\"\n    ordinal: int\n\n    lineage_tag: UUID = uuid4()\n    source_lineage_tag: UUID = uuid4()\n\n    modified_time: datetime.datetime\n\n    def column(self) -&gt; \"Column\":\n        return self.tabular_model.columns.find({\"id\": self.column_id})\n\n    def hierarchy(self) -&gt; \"Hierarchy\":\n        return self.tabular_model.hierarchies.find({\"id\": self.hierarchy_id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        return LineageNode(\n            self,\n            lineage_type,\n            [self.column().get_lineage(lineage_type), self.hierarchy().get_lineage(lineage_type)],\n        )\n</code></pre>"},{"location":"SSAS/entities/level/#pbi_core.ssas.model_tables.level.Level.description","title":"description  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>description: str | None = None\n</code></pre> <p>A description of the level, which may be used in the hover tooltip in edit mode</p>"},{"location":"SSAS/entities/level/#pbi_core.ssas.model_tables.level.Level.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre> <p>The name of the level, e.g. \"Year\", \"Quarter\", \"Month\", \"Day\" in a Date hierarchy.</p>"},{"location":"SSAS/entities/linguistic_metadata/","title":"Linguistic Metadata","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/linguistic_metadata.py</code> <pre><code>class LinguisticMetadata(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/f8924a45-70da-496a-947a-84b8d5beaae6)\n    \"\"\"\n\n    content: pydantic.Json[LinguisticMetadataContent]\n    content_type: ContentType\n    culture_id: int\n\n    modified_time: datetime.datetime\n\n    def culture(self) -&gt; \"Culture\":\n        return self.tabular_model.cultures.find({\"id\": self.culture_id})\n\n    def pbi_core_name(self) -&gt; str:\n        \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n        return self.culture().pbi_core_name()\n\n    @classmethod\n    def _db_command_obj_name(cls) -&gt; str:\n        return \"LinguisticMetadata\"\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        return LineageNode(self, lineage_type, [self.culture().get_lineage(lineage_type)])\n</code></pre>"},{"location":"SSAS/entities/linguistic_metadata/#pbi_core.ssas.model_tables.linguistic_metadata.LinguisticMetadata.pbi_core_name","title":"pbi_core_name","text":"<pre><code>pbi_core_name() -&gt; str\n</code></pre> <p>Returns the name displayed in the PBIX report.</p> Source code in <code>pbi_core/ssas/model_tables/linguistic_metadata.py</code> <pre><code>def pbi_core_name(self) -&gt; str:\n    \"\"\"Returns the name displayed in the PBIX report.\"\"\"\n    return self.culture().pbi_core_name()\n</code></pre>"},{"location":"SSAS/entities/measure/","title":"Measure","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>class Measure(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/ab331e04-78f7-49f0-861f-3f155b8b4c5b)\n    \"\"\"\n\n    data_category: str | None = None\n    data_type: DataType\n    description: str | None = None\n    \"\"\"This description will appear in the hover-over for the measure in the edit mode of the report\"\"\"\n\n    detail_rows_definition_id: int | None = None\n    display_folder: str | None = None\n    error_message: str | None = None\n    expression: str | int | float | None = None\n    format_string: str | int | None = None\n    \"\"\"A static definition for the formatting of the measure\"\"\"\n\n    format_string_definition_id: int | None = None\n    \"\"\"A foreign key to a FormatStringDefinition object. Used for dynamic-type measure formatting.\n\n    Note:\n        Mutually exclusive with format_string\n    \"\"\"\n    is_hidden: bool = False\n    \"\"\"Controls whether the measure appears in the edit mode of the report\"\"\"\n    is_simple_measure: bool\n    kpi_id: int | None = None\n    name: str\n    \"\"\"The name of the measure\"\"\"\n    state: DataState\n    table_id: int\n\n    lineage_tag: UUID = uuid4()\n    source_lineage_tag: UUID = uuid4()\n\n    modified_time: datetime.datetime\n    structure_modified_time: datetime.datetime\n\n    def expression_ast(self) -&gt; dax.Expression | None:\n        if not isinstance(self.expression, str):\n            return None\n        ret = dax.to_ast(self.expression)\n        if ret is None:\n            msg = \"Failed to parse DAX expression from measure\"\n            raise ValueError(msg)\n        return ret\n\n    def detail_rows_definition(self) -&gt; \"DetailRowDefinition | None\":\n        if self.detail_rows_definition_id is None:\n            return None\n        return self.tabular_model.detail_row_definitions.find(self.detail_rows_definition_id)\n\n    def format_string_definition(self) -&gt; \"FormatStringDefinition | None\":\n        if self.format_string_definition_id is None:\n            return None\n        return self.tabular_model.format_string_definitions.find(self.format_string_definition_id)\n\n    def KPI(self) -&gt; \"KPI | None\":  # noqa: N802\n        if self.kpi_id is not None:\n            return self.tabular_model.kpis.find({\"id\": self.kpi_id})\n        return None\n\n    def table(self) -&gt; \"Table\":\n        \"\"\"The Table object the measure is saved under.\"\"\"\n        return self.tabular_model.tables.find({\"id\": self.table_id})\n\n    def full_name(self) -&gt; str:\n        \"\"\"Returns the fully qualified name for DAX queries.\"\"\"\n        table_name = self.table().name\n        return f\"'{table_name}'[{self.name}]\"\n\n    def data(self, columns: Column | list[Column], head: int = 100) -&gt; list[dict[str, int | float | str]]:\n        if isinstance(columns, Column):\n            columns = [columns]\n        column_str = \"\\n\".join(\n            col.full_name() + \",\" for col in columns\n        )  # this should eventually be converted to jinja imo\n        command = f\"\"\"\n        EVALUATE TOPN({head}, SUMMARIZECOLUMNS(\n            {column_str}\n            {columns[0].table().name},\n            \"measure\", {self.full_name()}\n        ))\n        \"\"\"\n        return self.tabular_model.server.query_dax(command)\n\n    def __repr__(self) -&gt; str:\n        return f\"Measure({self.table().name}.{self.name})\"\n\n    def child_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"referenced_object_type\": \"MEASURE\",\n            \"referenced_table\": self.table().name,\n            \"referenced_object\": self.name,\n            \"object_type\": \"MEASURE\",\n        })\n        child_keys: list[tuple[str | None, str]] = [(m.table, m.object) for m in dependent_measures]\n        full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in child_keys]\n\n        if recursive:\n            recursive_dependencies: set[Measure] = set()\n            for dep in full_dependencies:\n                if f\"[{self.name}]\" in str(dep.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.child_measures(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{self.name}]\" in str(x.expression)}\n\n    def parent_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n        \"\"\"Calculated columns can use Measures too :(.\"\"\"\n        dependent_measures: set[CalcDependency] = self.tabular_model.calc_dependencies.find_all({\n            \"object_type\": \"MEASURE\",\n            \"table\": self.table().name,\n            \"object\": self.name,\n            \"referenced_object_type\": \"MEASURE\",\n        })\n        parent_keys = [(m.referenced_table, m.referenced_object) for m in dependent_measures]\n        full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in parent_keys]\n\n        if recursive:\n            recursive_dependencies: set[Measure] = set()\n            for dep in full_dependencies:\n                if f\"[{dep.name}]\" in str(self.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.parent_measures(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{x.name}]\" in str(self.expression)}\n\n    def child_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n        \"\"\"Only occurs when the dependent column is calculated (expression is not None).\"\"\"\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"referenced_object_type\": \"MEASURE\",\n            \"referenced_table\": self.table().name,\n            \"referenced_object\": self.name,\n        })\n        child_keys = [(m.table, m.object) for m in dependent_measures if m.object_type in {\"CALC_COLUMN\", \"COLUMN\"}]\n        full_dependencies = [m for m in self.tabular_model.columns if (m.table().name, m.explicit_name) in child_keys]\n\n        if recursive:\n            recursive_dependencies: set[Column] = set()\n            for dep in full_dependencies:\n                if f\"[{self.name}]\" in str(dep.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.child_columns(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{self.name}]\" in str(x.expression)}\n\n    def parent_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n        \"\"\"Only occurs when column is calculated.\"\"\"\n        dependent_measures = self.tabular_model.calc_dependencies.find_all({\n            \"object_type\": \"MEASURE\",\n            \"table\": self.table().name,\n            \"object\": self.name,\n        })\n        parent_keys = {\n            (m.referenced_table, m.referenced_object)\n            for m in dependent_measures\n            if m.referenced_object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n        }\n        full_dependencies = [c for c in self.tabular_model.columns if (c.table().name, c.explicit_name) in parent_keys]\n\n        if recursive:\n            recursive_dependencies: set[Column] = set()\n            for dep in full_dependencies:\n                if f\"[{dep.explicit_name}]\" in str(self.expression):\n                    recursive_dependencies.add(dep)\n                    recursive_dependencies.update(dep.parent_columns(recursive=True))\n            return recursive_dependencies\n\n        return {x for x in full_dependencies if f\"[{x.explicit_name}]\" in str(self.expression)}\n\n    def parents(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n        \"\"\"Returns all columns and measures this Measure is dependent on.\"\"\"\n        full_dependencies = self.parent_columns() | self.parent_measures()\n        if recursive:\n            recursive_dependencies: set[Column | Measure] = set()\n            for dep in full_dependencies:\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parents(recursive=True))\n            return recursive_dependencies\n\n        return full_dependencies\n\n    def children(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n        \"\"\"Returns all columns and measures dependent on this Measure.\"\"\"\n        full_dependencies = self.child_columns() | self.child_measures()\n        if recursive:\n            recursive_dependencies: set[Column | Measure] = set()\n            for dep in full_dependencies:\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.children(recursive=True))\n            return recursive_dependencies\n        return full_dependencies\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [c.get_lineage(lineage_type) for c in self.child_measures() | self.child_columns()],\n            )\n        parent_nodes: list[SsasTable | None] = [\n            self.KPI(),\n            self.table(),\n            *self.parent_measures(),\n            *self.parent_columns(),\n        ]\n        parent_lineage = [c.get_lineage(lineage_type) for c in parent_nodes if c is not None]\n        return LineageNode(self, lineage_type, parent_lineage)\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.description","title":"description  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>description: str | None = None\n</code></pre> <p>This description will appear in the hover-over for the measure in the edit mode of the report</p>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.format_string","title":"format_string  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>format_string: str | int | None = None\n</code></pre> <p>A static definition for the formatting of the measure</p>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.format_string_definition_id","title":"format_string_definition_id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>format_string_definition_id: int | None = None\n</code></pre> <p>A foreign key to a FormatStringDefinition object. Used for dynamic-type measure formatting.</p> Note <p>Mutually exclusive with format_string</p>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.is_hidden","title":"is_hidden  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>is_hidden: bool = False\n</code></pre> <p>Controls whether the measure appears in the edit mode of the report</p>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre> <p>The name of the measure</p>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.child_columns","title":"child_columns","text":"<pre><code>child_columns(*, recursive: bool = False) -&gt; set[Column]\n</code></pre> <p>Only occurs when the dependent column is calculated (expression is not None).</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def child_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n    \"\"\"Only occurs when the dependent column is calculated (expression is not None).\"\"\"\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"referenced_object_type\": \"MEASURE\",\n        \"referenced_table\": self.table().name,\n        \"referenced_object\": self.name,\n    })\n    child_keys = [(m.table, m.object) for m in dependent_measures if m.object_type in {\"CALC_COLUMN\", \"COLUMN\"}]\n    full_dependencies = [m for m in self.tabular_model.columns if (m.table().name, m.explicit_name) in child_keys]\n\n    if recursive:\n        recursive_dependencies: set[Column] = set()\n        for dep in full_dependencies:\n            if f\"[{self.name}]\" in str(dep.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.child_columns(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{self.name}]\" in str(x.expression)}\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.children","title":"children","text":"<pre><code>children(*, recursive: bool = False) -&gt; set[Column | Measure]\n</code></pre> <p>Returns all columns and measures dependent on this Measure.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def children(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n    \"\"\"Returns all columns and measures dependent on this Measure.\"\"\"\n    full_dependencies = self.child_columns() | self.child_measures()\n    if recursive:\n        recursive_dependencies: set[Column | Measure] = set()\n        for dep in full_dependencies:\n            recursive_dependencies.add(dep)\n            recursive_dependencies.update(dep.children(recursive=True))\n        return recursive_dependencies\n    return full_dependencies\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.full_name","title":"full_name","text":"<pre><code>full_name() -&gt; str\n</code></pre> <p>Returns the fully qualified name for DAX queries.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def full_name(self) -&gt; str:\n    \"\"\"Returns the fully qualified name for DAX queries.\"\"\"\n    table_name = self.table().name\n    return f\"'{table_name}'[{self.name}]\"\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.parent_columns","title":"parent_columns","text":"<pre><code>parent_columns(*, recursive: bool = False) -&gt; set[Column]\n</code></pre> <p>Only occurs when column is calculated.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def parent_columns(self, *, recursive: bool = False) -&gt; set[\"Column\"]:\n    \"\"\"Only occurs when column is calculated.\"\"\"\n    dependent_measures = self.tabular_model.calc_dependencies.find_all({\n        \"object_type\": \"MEASURE\",\n        \"table\": self.table().name,\n        \"object\": self.name,\n    })\n    parent_keys = {\n        (m.referenced_table, m.referenced_object)\n        for m in dependent_measures\n        if m.referenced_object_type in {\"CALC_COLUMN\", \"COLUMN\"}\n    }\n    full_dependencies = [c for c in self.tabular_model.columns if (c.table().name, c.explicit_name) in parent_keys]\n\n    if recursive:\n        recursive_dependencies: set[Column] = set()\n        for dep in full_dependencies:\n            if f\"[{dep.explicit_name}]\" in str(self.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parent_columns(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{x.explicit_name}]\" in str(self.expression)}\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.parent_measures","title":"parent_measures","text":"<pre><code>parent_measures(*, recursive: bool = False) -&gt; set[Measure]\n</code></pre> <p>Calculated columns can use Measures too :(.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def parent_measures(self, *, recursive: bool = False) -&gt; set[\"Measure\"]:\n    \"\"\"Calculated columns can use Measures too :(.\"\"\"\n    dependent_measures: set[CalcDependency] = self.tabular_model.calc_dependencies.find_all({\n        \"object_type\": \"MEASURE\",\n        \"table\": self.table().name,\n        \"object\": self.name,\n        \"referenced_object_type\": \"MEASURE\",\n    })\n    parent_keys = [(m.referenced_table, m.referenced_object) for m in dependent_measures]\n    full_dependencies = [m for m in self.tabular_model.measures if (m.table().name, m.name) in parent_keys]\n\n    if recursive:\n        recursive_dependencies: set[Measure] = set()\n        for dep in full_dependencies:\n            if f\"[{dep.name}]\" in str(self.expression):\n                recursive_dependencies.add(dep)\n                recursive_dependencies.update(dep.parent_measures(recursive=True))\n        return recursive_dependencies\n\n    return {x for x in full_dependencies if f\"[{x.name}]\" in str(self.expression)}\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.parents","title":"parents","text":"<pre><code>parents(*, recursive: bool = False) -&gt; set[Column | Measure]\n</code></pre> <p>Returns all columns and measures this Measure is dependent on.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def parents(self, *, recursive: bool = False) -&gt; \"set[Column | Measure]\":\n    \"\"\"Returns all columns and measures this Measure is dependent on.\"\"\"\n    full_dependencies = self.parent_columns() | self.parent_measures()\n    if recursive:\n        recursive_dependencies: set[Column | Measure] = set()\n        for dep in full_dependencies:\n            recursive_dependencies.add(dep)\n            recursive_dependencies.update(dep.parents(recursive=True))\n        return recursive_dependencies\n\n    return full_dependencies\n</code></pre>"},{"location":"SSAS/entities/measure/#pbi_core.ssas.model_tables.measure.Measure.table","title":"table","text":"<pre><code>table() -&gt; Table\n</code></pre> <p>The Table object the measure is saved under.</p> Source code in <code>pbi_core/ssas/model_tables/measure.py</code> <pre><code>def table(self) -&gt; \"Table\":\n    \"\"\"The Table object the measure is saved under.\"\"\"\n    return self.tabular_model.tables.find({\"id\": self.table_id})\n</code></pre>"},{"location":"SSAS/entities/model/","title":"Model","text":"<p>               Bases: <code>SsasModelRecord</code></p> <p>tbd.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/model.py</code> <pre><code>class Model(SsasModelRecord):\n    \"\"\"tbd.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/60094cd5-1c7e-4353-9299-251bfa838cc6)\n    \"\"\"\n\n    _default_refresh_type = RefreshType.Calculate\n\n    automatic_aggregation_options: str | None = None\n    collation: str | None = None\n    culture: str\n    data_access_options: Json[DataAccessOptions] = DataAccessOptions()\n    data_source_default_max_connections: int\n    data_source_variables_override_behavior: int\n    default_data_view: DefaultDataView\n    default_measure_id: int | None = None\n    default_mode: int\n    default_powerbi_data_source_version: int\n    description: str | None = None\n    discourage_composite_models: bool = True\n    discourage_implicit_measures: bool\n    disable_auto_exists: int | None = None\n    force_unique_names: bool\n    m_attributes: str | None = None\n    max_parallelism_per_refresh: int | None = None\n    max_parallelism_per_query: int | None = None\n    name: str\n    source_query_culture: str = \"en-US\"\n    storage_location: str | None = None\n    version: int\n\n    modified_time: datetime.datetime\n    structure_modified_time: datetime.datetime\n\n    def default_measure(self) -&gt; \"Measure | None\":\n        if self.default_measure_id is None:\n            return None\n        return self.tabular_model.measures.find(self.default_measure_id)\n\n    def cultures(self) -&gt; set[\"Culture\"]:\n        return self.tabular_model.cultures.find_all({\"model_id\": self.id})\n\n    def tables(self) -&gt; set[\"Table\"]:\n        return self.tabular_model.tables.find_all({\"model_id\": self.id})\n\n    def query_groups(self) -&gt; set[\"QueryGroup\"]:\n        return self.tabular_model.query_groups.find_all({\"model_id\": self.id})\n\n    @classmethod\n    def _db_command_obj_name(cls) -&gt; str:\n        return \"Model\"\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [c.get_lineage(lineage_type) for c in self.cultures()]\n                + [t.get_lineage(lineage_type) for t in self.tables()]\n                + [q.get_lineage(lineage_type) for q in self.query_groups()],\n            )\n        return LineageNode(self, lineage_type)\n</code></pre>"},{"location":"SSAS/entities/object_translation/","title":"Object Translation","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/object_translation.py</code> <pre><code>class ObjectTranslation(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/1eade819-5599-4ddd-9bf5-7d365806069d)\n    \"\"\"\n\n    altered: bool\n    culture_id: int\n    object_id: int\n    object_type: ObjectType\n    property: Property\n    value: str\n\n    modified_time: datetime.datetime\n\n    def object(self) -&gt; SsasTable:\n        \"\"\"Returns the object the annotation is describing.\n\n        Raises:\n            TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n        \"\"\"\n        if self.object_type == ObjectType.MODEL:\n            return self.tabular_model.model\n        mapper = {\n            ObjectType.DATASOURCE: self.tabular_model.data_sources,\n            ObjectType.TABLE: self.tabular_model.tables,\n            ObjectType.COLUMN: self.tabular_model.columns,\n            ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies,\n            ObjectType.PARTITION: self.tabular_model.partitions,\n            ObjectType.RELATIONSHIP: self.tabular_model.relationships,\n            ObjectType.MEASURE: self.tabular_model.measures,\n            ObjectType.HIERARCHY: self.tabular_model.hierarchies,\n            ObjectType.LEVEL: self.tabular_model.levels,\n            ObjectType.KPI: self.tabular_model.kpis,\n            ObjectType.CULTURE: self.tabular_model.cultures,\n            ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata,\n            ObjectType.PERSPECTIVE: self.tabular_model.perspectives,\n            ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables,\n            ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies,\n            ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures,\n            ObjectType.ROLE: self.tabular_model.roles,\n            ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships,\n            ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions,\n            ObjectType.VARIATION: self.tabular_model.variations,\n            ObjectType.EXPRESSION: self.tabular_model.expressions,\n            ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions,\n            ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups,\n            ObjectType.QUERY_GROUP: self.tabular_model.query_groups,\n        }\n        if self.object_type in mapper:\n            return mapper[self.object_type]\n        msg = f\"No logic implemented for type {self.object_type}\"\n        raise TypeError(msg)\n</code></pre>"},{"location":"SSAS/entities/object_translation/#pbi_core.ssas.model_tables.object_translation.ObjectTranslation.object","title":"object","text":"<pre><code>object() -&gt; SsasTable\n</code></pre> <p>Returns the object the annotation is describing.</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>When the Object Type doesn't map to a know SSAS entity type</p> Source code in <code>pbi_core/ssas/model_tables/object_translation.py</code> <pre><code>def object(self) -&gt; SsasTable:\n    \"\"\"Returns the object the annotation is describing.\n\n    Raises:\n        TypeError: When the Object Type doesn't map to a know SSAS entity type\n\n    \"\"\"\n    if self.object_type == ObjectType.MODEL:\n        return self.tabular_model.model\n    mapper = {\n        ObjectType.DATASOURCE: self.tabular_model.data_sources,\n        ObjectType.TABLE: self.tabular_model.tables,\n        ObjectType.COLUMN: self.tabular_model.columns,\n        ObjectType.ATTRIBUTE_HIERARCHY: self.tabular_model.attribute_hierarchies,\n        ObjectType.PARTITION: self.tabular_model.partitions,\n        ObjectType.RELATIONSHIP: self.tabular_model.relationships,\n        ObjectType.MEASURE: self.tabular_model.measures,\n        ObjectType.HIERARCHY: self.tabular_model.hierarchies,\n        ObjectType.LEVEL: self.tabular_model.levels,\n        ObjectType.KPI: self.tabular_model.kpis,\n        ObjectType.CULTURE: self.tabular_model.cultures,\n        ObjectType.LINGUISTIC_METADATA: self.tabular_model.linguistic_metadata,\n        ObjectType.PERSPECTIVE: self.tabular_model.perspectives,\n        ObjectType.PERSPECTIVE_TABLE: self.tabular_model.perspective_tables,\n        ObjectType.PERSPECTIVE_HIERARCHY: self.tabular_model.perspective_hierarchies,\n        ObjectType.PERSPECTIVE_MEASURE: self.tabular_model.perspective_measures,\n        ObjectType.ROLE: self.tabular_model.roles,\n        ObjectType.ROLE_MEMBERSHIP: self.tabular_model.role_memberships,\n        ObjectType.TABLE_PERMISSION: self.tabular_model.table_permissions,\n        ObjectType.VARIATION: self.tabular_model.variations,\n        ObjectType.EXPRESSION: self.tabular_model.expressions,\n        ObjectType.COLUMN_PERMISSION: self.tabular_model.column_permissions,\n        ObjectType.CALCULATION_GROUP: self.tabular_model.calculation_groups,\n        ObjectType.QUERY_GROUP: self.tabular_model.query_groups,\n    }\n    if self.object_type in mapper:\n        return mapper[self.object_type]\n    msg = f\"No logic implemented for type {self.object_type}\"\n    raise TypeError(msg)\n</code></pre>"},{"location":"SSAS/entities/partition/","title":"Partition","text":"<p>               Bases: <code>SsasRefreshRecord</code></p> <p>Partitions are a child of Tables. They contain the Power Query code.</p> <p>These are the physical segments of the table that contain the data. They cannot be edited within the Power BI Desktop UI, but can be edited in the Tabular Editor or other tools (like this one!). Data refreshes occur on the Partition-level.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/partition.py</code> <pre><code>class Partition(SsasRefreshRecord):\n    \"\"\"Partitions are a child of Tables. They contain the Power Query code.\n\n    These are the physical segments of the table that contain the data.\n    They cannot be edited within the Power BI Desktop UI, but can be edited in the\n    Tabular Editor or other tools (like this one!). Data refreshes occur on the Partition-level.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/81badb81-31a8-482b-ae16-5fc9d8291d9e)\n    \"\"\"\n\n    _default_refresh_typ = RefreshType.Full\n\n    data_view: DataView\n    data_source_id: int | None = None\n    description: str | None = None\n    error_message: str | None = None\n    expression_source_id: int | None = None\n    m_attributes: str | None = None\n    mode: PartitionMode\n    name: str\n    partition_storage_id: int\n    query_definition: str\n    query_group_id: int | None = None\n    range_granularity: int\n    retain_data_till_force_calculate: bool\n    state: DataState\n    system_flags: int\n    table_id: int\n    type: PartitionType\n\n    modified_time: datetime.datetime\n    refreshed_time: datetime.datetime\n\n    def expression_ast(self) -&gt; dax.Expression | pq.Expression | None:\n        if self.type == PartitionType.Calculated:\n            ret = pq.to_ast(self.query_definition)\n            if ret is None:\n                msg = \"Failed to parse DAX expression from partition query definition\"\n                raise ValueError(msg)\n        elif self.type == PartitionType.M:\n            ret = dax.to_ast(self.query_definition)\n            if ret is None:\n                msg = \"Failed to parse M expression from partition query definition\"\n                raise ValueError(msg)\n        else:\n            logger.warning(\"Attempted to get AST of non-M/DAX partition\", partition=self.name, type=self.type)\n            return None\n\n    def expression_source(self) -&gt; \"Expression | None\":\n        if self.expression_source_id is None:\n            return None\n        return self.tabular_model.expressions.find(self.expression_source_id)\n\n    def is_system_table(self) -&gt; bool:\n        return bool(self.system_flags &gt;&gt; 1 % 2)\n\n    def is_from_calculated_table(self) -&gt; bool:\n        return bool(self.system_flags % 2)\n\n    def query_group(self) -&gt; \"QueryGroup | None\":\n        try:\n            return self.tabular_model.query_groups.find({\"id\": self.table_id})\n        except RowNotFoundError:\n            return None\n\n    def table(self) -&gt; \"Table\":\n        return self.tabular_model.tables.find({\"id\": self.table_id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        parent_nodes: list[SsasTable | None] = [self.table(), self.query_group()]\n        parent_lineage: list[LineageNode] = [c.get_lineage(lineage_type) for c in parent_nodes if c is not None]\n        return LineageNode(self, lineage_type, parent_lineage)\n\n    def remove_columns(self, dropped_columns: \"Iterable[Column | str | None]\") -&gt; BeautifulSoup:\n        def pq_escape(x: str) -&gt; str:\n            \"\"\"Beginning of column escaping for power query.\"\"\"\n            return x.replace('\"', '\"\"')\n\n        \"\"\"Adds a Table.RemoveColumns statement to the end of the Partition's PowerQuery.\n\n        This means the upon refresh, the columns will not be included in the table\n        \"\"\"\n        new_dropped_columns: list[str] = []\n        for col in dropped_columns:\n            if isinstance(col, Column):\n                # Tables have a column named \"RowNumber-&lt;UUID&gt;\" that cannot be removed in the PowerQuery\n                if col._column_type() != \"CALC_COLUMN\" and not col.is_key:\n                    assert col.explicit_name is not None, \"Column must have an explicit name to be dropped\"\n                    new_dropped_columns.append(col.explicit_name)\n            elif isinstance(col, str):\n                new_dropped_columns.append(col)\n\n        # TODO: create a powerquery parser to do this robustly\n        new_dropped_columns = [pq_escape(x) for x in new_dropped_columns]\n        logger.info(\"Updating partition to drop columns\", table=self.table().name, columns=new_dropped_columns)\n        lines = self.query_definition.split(\"\\n\")\n        final_table_name = lines[-1].strip()\n        setup = \"\\n\".join(lines[:-2])\n\n        prior_updates = setup.count(\"pbi_update\")  # used to keep statement variables unique when applied multiple times\n        new_final_table_name = f\"pbi_update{prior_updates}\"\n\n        cols = \", \".join(f'\"{x}\"' for x in new_dropped_columns)\n        setup += f\",\\n    {new_final_table_name} = Table.RemoveColumns({final_table_name}, {{{cols}}})\"\n        setup += f\"\\nin\\n    {new_final_table_name}\"\n        self.query_definition = setup\n        return self.alter()\n</code></pre>"},{"location":"SSAS/entities/perspective/","title":"Perspective","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/perspective.py</code> <pre><code>class Perspective(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/8bbe314e-f308-4732-875c-9530a1b0fe95)\n    \"\"\"\n\n    description: int\n    model_id: int\n    name: str\n\n    modified_time: datetime.datetime\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n</code></pre>"},{"location":"SSAS/entities/perspective_column/","title":"Perspective Column","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/perspective_column.py</code> <pre><code>class PerspectiveColumn(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/f468353f-81a9-4a95-bb66-8997602bcd6d)\n    \"\"\"\n\n    column_id: int\n    perspective_table_id: int\n\n    modified_time: datetime.datetime\n\n    def perspective_table(self) -&gt; \"PerspectiveTable\":\n        return self.tabular_model.perspective_tables.find(self.perspective_table_id)\n\n    def column(self) -&gt; \"Column\":\n        return self.tabular_model.columns.find(self.column_id)\n</code></pre>"},{"location":"SSAS/entities/perspective_hierarchy/","title":"Perspective Hierarchy","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/perspective_hierarchy.py</code> <pre><code>class PerspectiveHierarchy(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/07941935-98bf-4e14-ab40-ef97d5c29765)\n    \"\"\"\n\n    hierarchy_id: int\n    perspective_table_id: int\n\n    modified_time: datetime.datetime\n\n    def perspective_table(self) -&gt; \"PerspectiveTable\":\n        return self.tabular_model.perspective_tables.find(self.perspective_table_id)\n\n    def hierarchy(self) -&gt; \"Hierarchy\":\n        return self.tabular_model.hierarchies.find(self.hierarchy_id)\n</code></pre>"},{"location":"SSAS/entities/perspective_measure/","title":"Perspective Measure","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/perspective_measure.py</code> <pre><code>class PerspectiveMeasure(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/d6bda989-a6d0-42c9-954b-3494b5857db4)\n    \"\"\"\n\n    measure_id: int\n    perspective_table_id: int\n\n    modified_time: datetime.datetime\n\n    def perspective_table(self) -&gt; \"PerspectiveTable\":\n        return self.tabular_model.perspective_tables.find(self.perspective_table_id)\n\n    def measure(self) -&gt; \"Measure\":\n        return self.tabular_model.measures.find(self.measure_id)\n</code></pre>"},{"location":"SSAS/entities/perspective_set/","title":"Perspective Set","text":"<p>               Bases: <code>SsasTable</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/perspective_set.py</code> <pre><code>class PerspectiveSet(SsasTable):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n</code></pre>"},{"location":"SSAS/entities/perspective_table/","title":"Perspective Table","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/perspective_table.py</code> <pre><code>class PerspectiveTable(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/06bc5956-20e3-4bd2-8e5f-68a200efc18b)\n    \"\"\"\n\n    include_all: bool\n    perspective_id: int\n    table_id: int\n\n    modified_time: datetime.datetime\n\n    def perspective(self) -&gt; \"Perspective\":\n        return self.tabular_model.perspectives.find(self.perspective_id)\n\n    def table(self) -&gt; \"Table\":\n        return self.tabular_model.tables.find(self.table_id)\n</code></pre>"},{"location":"SSAS/entities/query_group/","title":"Query Group","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft This class represents a group of queries that can be executed together.</p> Source code in <code>pbi_core/ssas/model_tables/query_group.py</code> <pre><code>class QueryGroup(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/40b3830b-25ee-41a6-87d2-49616028dd13)\n    This class represents a group of queries that can be executed together.\n    \"\"\"\n\n    _repr_name_field = \"folder\"\n\n    description: str | None = None\n    folder: str\n    model_id: int\n\n    def expressions(self) -&gt; set[\"Expression\"]:\n        return self.tabular_model.expressions.find_all({\"query_group_id\": self.id})\n\n    def partitions(self) -&gt; set[\"Partition\"]:\n        return self.tabular_model.partitions.find_all({\"query_group_id\": self.id})\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [expression.get_lineage(lineage_type) for expression in self.expressions()]\n                + [partition.get_lineage(lineage_type) for partition in self.partitions()],\n            )\n        return LineageNode(self, lineage_type, [self.model().get_lineage(lineage_type)])\n</code></pre>"},{"location":"SSAS/entities/refresh_policy/","title":"Refresh Policy","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft This class represents the refresh policy for a partition in a Tabular model.</p> Source code in <code>pbi_core/ssas/model_tables/refresh_policy.py</code> <pre><code>class RefreshPolicy(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/e11ae511-5064-470b-8abc-e2a4dd3999e6)\n    This class represents the refresh policy for a partition in a Tabular model.\n    \"\"\"\n\n    incremental_granularity: Granularity\n    incremental_periods: int\n    incremental_periods_offset: int\n    mode: RefreshMode\n    policy_type: PolicyType\n    polling_expression: str\n    rolling_window_granularity: Granularity\n    rolling_window_periods: int\n    source_expression: str\n    table_id: int\n</code></pre>"},{"location":"SSAS/entities/related_column_detail/","title":"Related Column Detail","text":"<p>               Bases: <code>SsasTable</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/related_column_detail.py</code> <pre><code>class RelatedColumnDetail(SsasTable):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n\n    @classmethod\n    def _db_type_name(cls) -&gt; str:\n        return \"RelatedColumnDetails\"\n</code></pre>"},{"location":"SSAS/entities/relationship/","title":"Relationship","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft This class represents a relationship between two tables in a Tabular model.</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>class Relationship(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/35bb4a68-b97e-409b-a5dd-14695fd99139)\n    This class represents a relationship between two tables in a Tabular model.\n    \"\"\"\n\n    cross_filtering_behavior: CrossFilteringBehavior\n    from_column_id: int\n    from_cardinality: int\n    from_table_id: int\n    is_active: bool\n    join_on_date_behavior: JoinOnDateBehavior\n    model_id: int\n    name: str\n    relationship_storage_id: int | None = None\n    relationship_storage2_id: int | None = None\n    relationship_storage2id: int | None = None  # TODO: check which one is wrong\n    rely_on_referential_integrity: bool\n    security_filtering_behavior: SecurityFilteringBehavior\n    state: DataState\n    to_cardinality: int\n    to_column_id: int\n    to_table_id: int\n    type: RelationshipType\n\n    modified_time: datetime.datetime\n    refreshed_time: datetime.datetime\n\n    def from_table(self) -&gt; \"Table\":\n        \"\"\"Returns the table the relationship is using as a filter.\n\n        Note:\n            In the bi-directional case, this table is also filtered\n\n        \"\"\"\n        return self.tabular_model.tables.find({\"id\": self.from_table_id})\n\n    def to_table(self) -&gt; \"Table\":\n        \"\"\"Returns the table the relationship is being filtered.\n\n        Note:\n            In the bi-directional case, this table is also used as a filter\n\n        \"\"\"\n        return self.tabular_model.tables.find({\"id\": self.to_table_id})\n\n    def from_column(self) -&gt; \"Column\":\n        \"\"\"The column in the from_table used to join with the to_table.\"\"\"\n        return self.tabular_model.columns.find({\"id\": self.from_column_id})\n\n    def to_column(self) -&gt; \"Column\":\n        \"\"\"The column in the to_table used to join with the from_table.\"\"\"\n        return self.tabular_model.columns.find({\"id\": self.to_column_id})\n\n    def model(self) -&gt; \"Model\":\n        \"\"\"The DB model this entity exists in.\"\"\"\n        return self.tabular_model.model\n\n    def variations(self) -&gt; set[\"Variation\"]:\n        return self.tabular_model.variations.find_all({\"relationship_id\": self.id})\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [variation.get_lineage(lineage_type) for variation in self.variations()],\n            )\n        return LineageNode(\n            self,\n            lineage_type,\n            [\n                self.from_table().get_lineage(lineage_type),\n                self.to_table().get_lineage(lineage_type),\n                self.from_column().get_lineage(lineage_type),\n                self.to_column().get_lineage(lineage_type),\n            ],\n        )\n\n    def __repr__(self) -&gt; str:\n        return f\"{self.__class__.__name__}({self.id}, from: {self.from_table()!r}, to: {self.to_table()!r})\"\n</code></pre>"},{"location":"SSAS/entities/relationship/#pbi_core.ssas.model_tables.relationship.Relationship.from_column","title":"from_column","text":"<pre><code>from_column() -&gt; Column\n</code></pre> <p>The column in the from_table used to join with the to_table.</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>def from_column(self) -&gt; \"Column\":\n    \"\"\"The column in the from_table used to join with the to_table.\"\"\"\n    return self.tabular_model.columns.find({\"id\": self.from_column_id})\n</code></pre>"},{"location":"SSAS/entities/relationship/#pbi_core.ssas.model_tables.relationship.Relationship.from_table","title":"from_table","text":"<pre><code>from_table() -&gt; Table\n</code></pre> <p>Returns the table the relationship is using as a filter.</p> Note <p>In the bi-directional case, this table is also filtered</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>def from_table(self) -&gt; \"Table\":\n    \"\"\"Returns the table the relationship is using as a filter.\n\n    Note:\n        In the bi-directional case, this table is also filtered\n\n    \"\"\"\n    return self.tabular_model.tables.find({\"id\": self.from_table_id})\n</code></pre>"},{"location":"SSAS/entities/relationship/#pbi_core.ssas.model_tables.relationship.Relationship.model","title":"model","text":"<pre><code>model() -&gt; Model\n</code></pre> <p>The DB model this entity exists in.</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>def model(self) -&gt; \"Model\":\n    \"\"\"The DB model this entity exists in.\"\"\"\n    return self.tabular_model.model\n</code></pre>"},{"location":"SSAS/entities/relationship/#pbi_core.ssas.model_tables.relationship.Relationship.to_column","title":"to_column","text":"<pre><code>to_column() -&gt; Column\n</code></pre> <p>The column in the to_table used to join with the from_table.</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>def to_column(self) -&gt; \"Column\":\n    \"\"\"The column in the to_table used to join with the from_table.\"\"\"\n    return self.tabular_model.columns.find({\"id\": self.to_column_id})\n</code></pre>"},{"location":"SSAS/entities/relationship/#pbi_core.ssas.model_tables.relationship.Relationship.to_table","title":"to_table","text":"<pre><code>to_table() -&gt; Table\n</code></pre> <p>Returns the table the relationship is being filtered.</p> Note <p>In the bi-directional case, this table is also used as a filter</p> Source code in <code>pbi_core/ssas/model_tables/relationship.py</code> <pre><code>def to_table(self) -&gt; \"Table\":\n    \"\"\"Returns the table the relationship is being filtered.\n\n    Note:\n        In the bi-directional case, this table is also used as a filter\n\n    \"\"\"\n    return self.tabular_model.tables.find({\"id\": self.to_table_id})\n</code></pre>"},{"location":"SSAS/entities/role/","title":"Role","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/role.py</code> <pre><code>class Role(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/94a8e609-b1ae-4814-b8dc-963005eebade)\n    \"\"\"\n\n    description: str | None = None\n    model_id: int\n    model_permission: ModelPermission\n    name: str\n\n    modified_time: datetime.datetime\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n</code></pre>"},{"location":"SSAS/entities/role_membership/","title":"Role Membership","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/role_membership.py</code> <pre><code>class RoleMembership(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/dbecc1f4-142b-4765-8374-a4d4dc51313b)\n    \"\"\"\n\n    identity_provider: str\n    member_id: str\n    member_name: str\n    member_type: MemberType\n    role_id: int\n\n    modified_time: datetime.datetime\n\n    def role(self) -&gt; \"Role\":\n        return self.tabular_model.roles.find(self.role_id)\n</code></pre>"},{"location":"SSAS/entities/set/","title":"Set","text":"<p>               Bases: <code>SsasTable</code></p> <p>TBD.</p> <p>SSAS spec:</p> Source code in <code>pbi_core/ssas/model_tables/set.py</code> <pre><code>class Set(SsasTable):\n    \"\"\"TBD.\n\n    SSAS spec:\n    \"\"\"\n</code></pre>"},{"location":"SSAS/entities/table/","title":"Table","text":"<p>               Bases: <code>SsasRefreshRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>class Table(SsasRefreshRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/6360ac84-0717-4170-bce0-284cbef419ca)\n    \"\"\"\n\n    _refresh_type = RefreshType.DataOnly\n\n    alternate_source_precedence: int\n    calculation_group_id: int | None = None\n    data_category: DataCategory | None = None\n    default_detail_rows_defintion_id: int | None = None\n    description: str | None = None\n    \"\"\"A description of the table, which may be used in the hover tooltip in edit mode\"\"\"\n    exclude_from_automatic_aggregations: bool = False\n    exclude_from_model_refresh: bool\n    \"\"\"Controls whether this table is included in the model-wide refresh process\"\"\"\n    is_hidden: bool\n    \"\"\"Controls whether the table appears in the edit mode of the report\"\"\"\n    is_private: bool\n    model_id: int\n    \"\"\"The ID of the model this table belongs to\"\"\"\n    name: str\n    \"\"\"The name of the table as it appears in the report\"\"\"\n    refresh_policy_id: int | None = None\n    show_as_variations_only: bool\n    system_flags: int\n    system_managed: bool | None = None\n    table_storage_id: int | None = None\n\n    lineage_tag: UUID = uuid4()\n    source_lineage_tag: UUID = uuid4()\n\n    modified_time: datetime.datetime\n    structure_modified_time: datetime.datetime\n\n    def calculation_group(self) -&gt; \"CalculationGroup | None\":\n        if self.calculation_group_id is None:\n            return None\n        return self.tabular_model.calculation_groups.find(self.calculation_group_id)\n\n    def refresh_policy(self) -&gt; \"RefreshPolicy | None\":\n        if self.refresh_policy_id is None:\n            return None\n        return self.tabular_model.refresh_policies.find(self.refresh_policy_id)\n\n    def is_system_table(self) -&gt; bool:\n        return bool(self.system_flags &gt;&gt; 1 % 2)\n\n    def is_from_calculated_table(self) -&gt; bool:\n        return bool(self.system_flags % 2)\n\n    def data(self, head: int = 100) -&gt; list[dict[str, int | float | str]]:\n        \"\"\"Extracts records from the table in SSAS.\n\n        Args:\n            head (int): The number of records to return from the table.\n\n        Returns:\n            list[dict[str, int | float | str]]: A list of SSAS records in dictionary form.\n                The keys are the field names and the values are the record values\n\n        \"\"\"\n        return self.tabular_model.server.query_dax(\n            f\"EVALUATE TOPN({head}, ALL('{self.name}'))\",\n            db_name=self.tabular_model.db_name,\n        )\n\n    def partitions(self) -&gt; set[Partition]:\n        \"\"\"Get associated dependent partitions.\n\n        Returns:\n            (set[Partition]): A list of the partitions containing data for this table\n\n        \"\"\"\n        return self.tabular_model.partitions.find_all({\"table_id\": self.id})\n\n    def columns(self) -&gt; set[Column]:\n        \"\"\"Get associated dependent partitions.\n\n        Returns:\n            (set[Column]): A list of the columns in this table\n\n        \"\"\"\n        return self.tabular_model.columns.find_all({\"table_id\": self.id})\n\n    def default_row_definition(self) -&gt; \"DetailRowDefinition | None\":\n        if self.default_detail_rows_defintion_id is None:\n            return None\n        return self.tabular_model.detail_row_definitions.find(self.default_detail_rows_defintion_id)\n\n    def table_measures(self) -&gt; set[Measure]:\n        \"\"\"Get measures saved to this table.\n\n        Returns:\n            (set[Measure]): A list of measures saved to this table\n\n        Note:\n            These measures do not necessarily have calculations that depend on this table.\n                For that use `table.measures()`\n\n        \"\"\"\n        return self.tabular_model.measures.find_all({\"table_id\": self.id})\n\n    def measures(self) -&gt; set[Measure]:\n        \"\"\"Get measures that logically depend on this table.\n\n        Examples:\n            ```python\n            print(measure.expression)\n            # sumx(example, [a])\n\n            Table(name=example).measures()\n            # [..., Measure(name='measure'), ...]\n            ```\n\n        Returns:\n            (set[Measure]): A list of measures that logically depend this table\n\n        Note:\n            These measures are not necessarily saved physically to this table. For that use `table.table_measures()`\n\n        \"\"\"\n        raise NotImplementedError\n\n    def model(self) -&gt; \"Model\":\n        return self.tabular_model.model\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(\n                self,\n                lineage_type,\n                [col.get_lineage(lineage_type) for col in self.columns()]\n                + [partition.get_lineage(lineage_type) for partition in self.partitions()]\n                + [measure.get_lineage(lineage_type) for measure in self.measures()],\n            )\n        return LineageNode(self, lineage_type, [self.model().get_lineage(lineage_type)])\n\n    def refresh(self, *, include_model_refresh: bool = True) -&gt; list[BeautifulSoup]:  # pyright: ignore reportIncompatibleMethodOverride\n        \"\"\"Needs a model refresh to properly propogate the update.\"\"\"\n        if include_model_refresh:\n            return [\n                super().refresh(),\n                self.model().refresh(),\n            ]\n        return [super().refresh()]\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.description","title":"description  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>description: str | None = None\n</code></pre> <p>A description of the table, which may be used in the hover tooltip in edit mode</p>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.exclude_from_model_refresh","title":"exclude_from_model_refresh  <code>instance-attribute</code>","text":"<pre><code>exclude_from_model_refresh: bool\n</code></pre> <p>Controls whether this table is included in the model-wide refresh process</p>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.is_hidden","title":"is_hidden  <code>instance-attribute</code>","text":"<pre><code>is_hidden: bool\n</code></pre> <p>Controls whether the table appears in the edit mode of the report</p>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.model_id","title":"model_id  <code>instance-attribute</code>","text":"<pre><code>model_id: int\n</code></pre> <p>The ID of the model this table belongs to</p>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre> <p>The name of the table as it appears in the report</p>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.columns","title":"columns","text":"<pre><code>columns() -&gt; set[Column]\n</code></pre> <p>Get associated dependent partitions.</p> <p>Returns:</p> Type Description <code>set[Column]</code> <p>A list of the columns in this table</p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def columns(self) -&gt; set[Column]:\n    \"\"\"Get associated dependent partitions.\n\n    Returns:\n        (set[Column]): A list of the columns in this table\n\n    \"\"\"\n    return self.tabular_model.columns.find_all({\"table_id\": self.id})\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.data","title":"data","text":"<pre><code>data(head: int = 100) -&gt; list[dict[str, int | float | str]]\n</code></pre> <p>Extracts records from the table in SSAS.</p> <p>Parameters:</p> Name Type Description Default <code>head</code> <code>int</code> <p>The number of records to return from the table.</p> <code>100</code> <p>Returns:</p> Type Description <code>list[dict[str, int | float | str]]</code> <p>list[dict[str, int | float | str]]: A list of SSAS records in dictionary form. The keys are the field names and the values are the record values</p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def data(self, head: int = 100) -&gt; list[dict[str, int | float | str]]:\n    \"\"\"Extracts records from the table in SSAS.\n\n    Args:\n        head (int): The number of records to return from the table.\n\n    Returns:\n        list[dict[str, int | float | str]]: A list of SSAS records in dictionary form.\n            The keys are the field names and the values are the record values\n\n    \"\"\"\n    return self.tabular_model.server.query_dax(\n        f\"EVALUATE TOPN({head}, ALL('{self.name}'))\",\n        db_name=self.tabular_model.db_name,\n    )\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.measures","title":"measures","text":"<pre><code>measures() -&gt; set[Measure]\n</code></pre> <p>Get measures that logically depend on this table.</p> <p>Examples:</p> <pre><code>print(measure.expression)\n# sumx(example, [a])\n\nTable(name=example).measures()\n# [..., Measure(name='measure'), ...]\n</code></pre> <p>Returns:</p> Type Description <code>set[Measure]</code> <p>A list of measures that logically depend this table</p> Note <p>These measures are not necessarily saved physically to this table. For that use <code>table.table_measures()</code></p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def measures(self) -&gt; set[Measure]:\n    \"\"\"Get measures that logically depend on this table.\n\n    Examples:\n        ```python\n        print(measure.expression)\n        # sumx(example, [a])\n\n        Table(name=example).measures()\n        # [..., Measure(name='measure'), ...]\n        ```\n\n    Returns:\n        (set[Measure]): A list of measures that logically depend this table\n\n    Note:\n        These measures are not necessarily saved physically to this table. For that use `table.table_measures()`\n\n    \"\"\"\n    raise NotImplementedError\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.partitions","title":"partitions","text":"<pre><code>partitions() -&gt; set[Partition]\n</code></pre> <p>Get associated dependent partitions.</p> <p>Returns:</p> Type Description <code>set[Partition]</code> <p>A list of the partitions containing data for this table</p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def partitions(self) -&gt; set[Partition]:\n    \"\"\"Get associated dependent partitions.\n\n    Returns:\n        (set[Partition]): A list of the partitions containing data for this table\n\n    \"\"\"\n    return self.tabular_model.partitions.find_all({\"table_id\": self.id})\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.refresh","title":"refresh","text":"<pre><code>refresh(*, include_model_refresh: bool = True) -&gt; list[BeautifulSoup]\n</code></pre> <p>Needs a model refresh to properly propogate the update.</p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def refresh(self, *, include_model_refresh: bool = True) -&gt; list[BeautifulSoup]:  # pyright: ignore reportIncompatibleMethodOverride\n    \"\"\"Needs a model refresh to properly propogate the update.\"\"\"\n    if include_model_refresh:\n        return [\n            super().refresh(),\n            self.model().refresh(),\n        ]\n    return [super().refresh()]\n</code></pre>"},{"location":"SSAS/entities/table/#pbi_core.ssas.model_tables.table.Table.table_measures","title":"table_measures","text":"<pre><code>table_measures() -&gt; set[Measure]\n</code></pre> <p>Get measures saved to this table.</p> <p>Returns:</p> Type Description <code>set[Measure]</code> <p>A list of measures saved to this table</p> Note <p>These measures do not necessarily have calculations that depend on this table.     For that use <code>table.measures()</code></p> Source code in <code>pbi_core/ssas/model_tables/table.py</code> <pre><code>def table_measures(self) -&gt; set[Measure]:\n    \"\"\"Get measures saved to this table.\n\n    Returns:\n        (set[Measure]): A list of measures saved to this table\n\n    Note:\n        These measures do not necessarily have calculations that depend on this table.\n            For that use `table.measures()`\n\n    \"\"\"\n    return self.tabular_model.measures.find_all({\"table_id\": self.id})\n</code></pre>"},{"location":"SSAS/entities/table_permission/","title":"Table Permission","text":"<p>               Bases: <code>SsasEditableRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/table_permission.py</code> <pre><code>class TablePermission(SsasEditableRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/ac2ceeb3-a54e-4bf5-85b0-a770d4b1716e)\n    \"\"\"\n\n    error_message: str | None = None\n    filter_expression: str | None = None\n    metadata_permission: MetadataPermission\n    role_id: int\n    state: DataState\n    table_id: int\n\n    modified_time: datetime.datetime\n\n    def role(self) -&gt; \"Role\":\n        return self.tabular_model.roles.find(self.role_id)\n</code></pre>"},{"location":"SSAS/entities/variation/","title":"Variation","text":"<p>               Bases: <code>SsasRenameRecord</code></p> <p>TBD.</p> <p>SSAS spec: Microsoft</p> Source code in <code>pbi_core/ssas/model_tables/variation.py</code> <pre><code>class Variation(SsasRenameRecord):\n    \"\"\"TBD.\n\n    SSAS spec: [Microsoft](https://learn.microsoft.com/en-us/openspecs/sql_server_protocols/ms-ssas-t/b9dfeb51-cbb6-4eab-91bd-fa2b23f51ca3)\n    \"\"\"\n\n    column: int | None = None  # TODO: pbi says this shouldn't exist\n    column_id: int\n    default_column_id: int | None = None\n    default_hierarchy_id: int\n    description: str | None = None\n    is_default: bool\n    name: str\n    relationship_id: int\n\n    def get_column(self) -&gt; \"Column\":\n        \"\"\"Name is bad to not consistent with other methods because the column field in this entity :(.\"\"\"\n        return self.tabular_model.columns.find(self.column_id)\n\n    def default_column(self) -&gt; \"Column | None\":\n        if self.default_column_id is None:\n            return None\n        return self.tabular_model.columns.find(self.default_column_id)\n\n    def default_hierarchy(self) -&gt; \"Hierarchy\":\n        return self.tabular_model.hierarchies.find(self.default_hierarchy_id)\n\n    def relationship(self) -&gt; \"Relationship\":\n        return self.tabular_model.relationships.find(self.relationship_id)\n\n    def get_lineage(self, lineage_type: Literal[\"children\", \"parents\"]) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n        return LineageNode(\n            self,\n            lineage_type,\n            [\n                self.default_hierarchy().get_lineage(lineage_type),\n                self.relationship().get_lineage(lineage_type),\n            ],\n        )\n</code></pre>"},{"location":"SSAS/entities/variation/#pbi_core.ssas.model_tables.variation.Variation.get_column","title":"get_column","text":"<pre><code>get_column() -&gt; Column\n</code></pre> <p>Name is bad to not consistent with other methods because the column field in this entity :(.</p> Source code in <code>pbi_core/ssas/model_tables/variation.py</code> <pre><code>def get_column(self) -&gt; \"Column\":\n    \"\"\"Name is bad to not consistent with other methods because the column field in this entity :(.\"\"\"\n    return self.tabular_model.columns.find(self.column_id)\n</code></pre>"},{"location":"SSAS/infra/base_server/","title":"Base SSAS Server","text":"<p>Base Server Interface containing the methods used outside of instance lifetime management.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>class BaseServer:\n    \"\"\"Base Server Interface containing the methods used outside of instance lifetime management.\"\"\"\n\n    host: str\n    \"A hostname to the background SSAS instance\"\n\n    port: int\n    \"A Port to the background SSAS instance\"\n\n    default_db: str | None\n    \"\"\"The default DB to use when executing DAX\"\"\"\n\n    def __init__(self, host: str, port: int, default_db: str | None = None) -&gt; None:\n        self.host = host\n        self.port = port\n        self.default_db = default_db\n\n        self.check_ssas_sku()\n\n    def conn_str(self, db_name: str | None = None) -&gt; str:\n        \"\"\"Formats the connection string for connecting to the background SSAS instance.\"\"\"\n        if db_name:\n            return f\"Provider=MSOLAP;Data Source={self.host}:{self.port};Initial Catalog={db_name};\"\n        return f\"Provider=MSOLAP;Data Source={self.host}:{self.port};\"\n\n    def conn(self, db_name: str | None = None) -&gt; pbi_pyadomd.Connection:\n        \"\"\"Returns a pbi_pyadomd connection.\"\"\"\n        return pbi_pyadomd.connect(self.conn_str(db_name))\n\n    def __repr__(self) -&gt; str:\n        return f\"Server(host={self.host}:{self.port})\"\n\n    def query_dax(self, query: str, *, db_name: str | bool | None = True) -&gt; list[dict[str, Any]]:\n        \"\"\"db_name: when bool and == True, uses the DB last loaded by this server instance.\n\n        (almost always the db of the loaded PBI unless you're manually reassigning server instances)\n        when None or False, no db is supplied\n        when a string, just passed to the client\n        \"\"\"\n        if db_name is True:\n            db_name = self.default_db\n        elif db_name is False:\n            db_name = None\n        with self.conn(db_name) as conn:\n            cursor = conn.cursor()\n            cursor.execute_dax(query)\n            return cursor.fetch_all()\n\n    def query_xml(self, query: str, db_name: str | None = None) -&gt; BeautifulSoup:\n        \"\"\"Submits an XMLA query to the SSAS instance and returns the result as a BeautifulSoup object.\n\n        The query should be a valid XMLA command.\n\n        Args:\n            query (str): The XMLA query to execute.\n            db_name (str | None): The name of the database to execute the query against.\n\n        Returns:\n            BeautifulSoup: The result of the query parsed as a BeautifulSoup object.\n\n        \"\"\"\n        with self.conn(db_name) as conn:\n            return conn.execute_xml(query)\n\n    def tabular_models(self) -&gt; list[BaseTabularModel]:\n        \"\"\"Creates a list of the Tabular models existing in the SSAS server.\n\n        Note:\n            Generally tabular models in the local environment correspond 1-1 with a PBIX report open in the Desktop app\n\n        \"\"\"\n        # Query based on https://learn.microsoft.com/en-us/previous-versions/sql/sql-server-2012/ms126314(v=sql.110)\n        dbs = self.query_dax(COMMAND_TEMPLATES[\"list_dbs.xml\"].render())\n        return [BaseTabularModel(row[\"CATALOG_NAME\"], self) for row in dbs]\n\n    @backoff.on_exception(backoff.expo, ValueError, max_time=10)\n    def check_ssas_sku(self) -&gt; None:\n        \"\"\"Checks if the SSAS instance is running the correct SKU version.\n\n        Tests this assumption by running a query that should fail if the SKU under 1400 (image save command).\n        Since we could also fail due to the server not being instantiated, we use a backoff decorator\n        to retry the command a few times before giving up.\n\n        Raises:\n            TypeError: If the SSAS instance is running an incorrect SKU version.\n            ValueError: If the SSAS instance is not running or the command fails for another reason.\n                This is used to trigger the backoff retry.\n\n        \"\"\"\n        try:\n            self.query_xml(\n                COMMAND_TEMPLATES[\"image_save.xml\"].render(\n                    target_path=\"---\",\n                    db_name=\"---\",\n                ),  # specifically choosing non-existant values to verify we get at least one error\n            )\n        except pbi_pyadomd.AdomdErrorResponseException as e:\n            error_message = str(e.Message)\n            if error_message == SKU_ERROR:\n                return\n            msg = f\"Incorrect SKUVersion. We got the error: {error_message}\"\n            raise TypeError(msg) from None\n        msg = \"Got a 'file not loaded' type error. Waiting\"\n        raise ValueError(msg)\n\n    @staticmethod\n    def sanitize_xml(xml_text: str) -&gt; str:\n        \"\"\"Method to XML-encode characters like \"&amp;\" so that the Adomd connection doesn't mangle the XMLA commands.\"\"\"\n        return xml_text.replace(\"&amp;\", \"&amp;amp;\")\n\n    @staticmethod\n    def remove_invalid_db_name_chars(orig_db_name: str) -&gt; str:\n        \"\"\"Utility function to convert a PBIX report name to an equivalent name for the DB in the SSAS instance.\n\n        Note:\n            Raises a warning if the db_name is changed to inform user that the db_name does not match their input\n\n        \"\"\"\n        db_name = orig_db_name.replace(\"&amp;\", \" \")[:100]\n        db_name = db_name.strip()  # needed to find the correct name, since SSAS does stripping too\n        if orig_db_name != db_name:\n            logger.warning(\"db_name changed\", original_name=orig_db_name, new_name=db_name)\n        return db_name\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.default_db","title":"default_db  <code>instance-attribute</code>","text":"<pre><code>default_db: str | None = default_db\n</code></pre> <p>The default DB to use when executing DAX</p>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.host","title":"host  <code>instance-attribute</code>","text":"<pre><code>host: str = host\n</code></pre> <p>A hostname to the background SSAS instance</p>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.port","title":"port  <code>instance-attribute</code>","text":"<pre><code>port: int = port\n</code></pre> <p>A Port to the background SSAS instance</p>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.check_ssas_sku","title":"check_ssas_sku","text":"<pre><code>check_ssas_sku() -&gt; None\n</code></pre> <p>Checks if the SSAS instance is running the correct SKU version.</p> <p>Tests this assumption by running a query that should fail if the SKU under 1400 (image save command). Since we could also fail due to the server not being instantiated, we use a backoff decorator to retry the command a few times before giving up.</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>If the SSAS instance is running an incorrect SKU version.</p> <code>ValueError</code> <p>If the SSAS instance is not running or the command fails for another reason. This is used to trigger the backoff retry.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>@backoff.on_exception(backoff.expo, ValueError, max_time=10)\ndef check_ssas_sku(self) -&gt; None:\n    \"\"\"Checks if the SSAS instance is running the correct SKU version.\n\n    Tests this assumption by running a query that should fail if the SKU under 1400 (image save command).\n    Since we could also fail due to the server not being instantiated, we use a backoff decorator\n    to retry the command a few times before giving up.\n\n    Raises:\n        TypeError: If the SSAS instance is running an incorrect SKU version.\n        ValueError: If the SSAS instance is not running or the command fails for another reason.\n            This is used to trigger the backoff retry.\n\n    \"\"\"\n    try:\n        self.query_xml(\n            COMMAND_TEMPLATES[\"image_save.xml\"].render(\n                target_path=\"---\",\n                db_name=\"---\",\n            ),  # specifically choosing non-existant values to verify we get at least one error\n        )\n    except pbi_pyadomd.AdomdErrorResponseException as e:\n        error_message = str(e.Message)\n        if error_message == SKU_ERROR:\n            return\n        msg = f\"Incorrect SKUVersion. We got the error: {error_message}\"\n        raise TypeError(msg) from None\n    msg = \"Got a 'file not loaded' type error. Waiting\"\n    raise ValueError(msg)\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.conn","title":"conn","text":"<pre><code>conn(db_name: str | None = None) -&gt; pbi_pyadomd.Connection\n</code></pre> <p>Returns a pbi_pyadomd connection.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def conn(self, db_name: str | None = None) -&gt; pbi_pyadomd.Connection:\n    \"\"\"Returns a pbi_pyadomd connection.\"\"\"\n    return pbi_pyadomd.connect(self.conn_str(db_name))\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.conn_str","title":"conn_str","text":"<pre><code>conn_str(db_name: str | None = None) -&gt; str\n</code></pre> <p>Formats the connection string for connecting to the background SSAS instance.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def conn_str(self, db_name: str | None = None) -&gt; str:\n    \"\"\"Formats the connection string for connecting to the background SSAS instance.\"\"\"\n    if db_name:\n        return f\"Provider=MSOLAP;Data Source={self.host}:{self.port};Initial Catalog={db_name};\"\n    return f\"Provider=MSOLAP;Data Source={self.host}:{self.port};\"\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.query_dax","title":"query_dax","text":"<pre><code>query_dax(query: str, *, db_name: str | bool | None = True) -&gt; list[dict[str, Any]]\n</code></pre> <p>db_name: when bool and == True, uses the DB last loaded by this server instance.</p> <p>(almost always the db of the loaded PBI unless you're manually reassigning server instances) when None or False, no db is supplied when a string, just passed to the client</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def query_dax(self, query: str, *, db_name: str | bool | None = True) -&gt; list[dict[str, Any]]:\n    \"\"\"db_name: when bool and == True, uses the DB last loaded by this server instance.\n\n    (almost always the db of the loaded PBI unless you're manually reassigning server instances)\n    when None or False, no db is supplied\n    when a string, just passed to the client\n    \"\"\"\n    if db_name is True:\n        db_name = self.default_db\n    elif db_name is False:\n        db_name = None\n    with self.conn(db_name) as conn:\n        cursor = conn.cursor()\n        cursor.execute_dax(query)\n        return cursor.fetch_all()\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.query_xml","title":"query_xml","text":"<pre><code>query_xml(query: str, db_name: str | None = None) -&gt; BeautifulSoup\n</code></pre> <p>Submits an XMLA query to the SSAS instance and returns the result as a BeautifulSoup object.</p> <p>The query should be a valid XMLA command.</p> <p>Parameters:</p> Name Type Description Default <code>query</code> <code>str</code> <p>The XMLA query to execute.</p> required <code>db_name</code> <code>str | None</code> <p>The name of the database to execute the query against.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>BeautifulSoup</code> <code>BeautifulSoup</code> <p>The result of the query parsed as a BeautifulSoup object.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def query_xml(self, query: str, db_name: str | None = None) -&gt; BeautifulSoup:\n    \"\"\"Submits an XMLA query to the SSAS instance and returns the result as a BeautifulSoup object.\n\n    The query should be a valid XMLA command.\n\n    Args:\n        query (str): The XMLA query to execute.\n        db_name (str | None): The name of the database to execute the query against.\n\n    Returns:\n        BeautifulSoup: The result of the query parsed as a BeautifulSoup object.\n\n    \"\"\"\n    with self.conn(db_name) as conn:\n        return conn.execute_xml(query)\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.remove_invalid_db_name_chars","title":"remove_invalid_db_name_chars  <code>staticmethod</code>","text":"<pre><code>remove_invalid_db_name_chars(orig_db_name: str) -&gt; str\n</code></pre> <p>Utility function to convert a PBIX report name to an equivalent name for the DB in the SSAS instance.</p> Note <p>Raises a warning if the db_name is changed to inform user that the db_name does not match their input</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>@staticmethod\ndef remove_invalid_db_name_chars(orig_db_name: str) -&gt; str:\n    \"\"\"Utility function to convert a PBIX report name to an equivalent name for the DB in the SSAS instance.\n\n    Note:\n        Raises a warning if the db_name is changed to inform user that the db_name does not match their input\n\n    \"\"\"\n    db_name = orig_db_name.replace(\"&amp;\", \" \")[:100]\n    db_name = db_name.strip()  # needed to find the correct name, since SSAS does stripping too\n    if orig_db_name != db_name:\n        logger.warning(\"db_name changed\", original_name=orig_db_name, new_name=db_name)\n    return db_name\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.sanitize_xml","title":"sanitize_xml  <code>staticmethod</code>","text":"<pre><code>sanitize_xml(xml_text: str) -&gt; str\n</code></pre> <p>Method to XML-encode characters like \"&amp;\" so that the Adomd connection doesn't mangle the XMLA commands.</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>@staticmethod\ndef sanitize_xml(xml_text: str) -&gt; str:\n    \"\"\"Method to XML-encode characters like \"&amp;\" so that the Adomd connection doesn't mangle the XMLA commands.\"\"\"\n    return xml_text.replace(\"&amp;\", \"&amp;amp;\")\n</code></pre>"},{"location":"SSAS/infra/base_server/#pbi_core.ssas.server.server.BaseServer.tabular_models","title":"tabular_models","text":"<pre><code>tabular_models() -&gt; list[BaseTabularModel]\n</code></pre> <p>Creates a list of the Tabular models existing in the SSAS server.</p> Note <p>Generally tabular models in the local environment correspond 1-1 with a PBIX report open in the Desktop app</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def tabular_models(self) -&gt; list[BaseTabularModel]:\n    \"\"\"Creates a list of the Tabular models existing in the SSAS server.\n\n    Note:\n        Generally tabular models in the local environment correspond 1-1 with a PBIX report open in the Desktop app\n\n    \"\"\"\n    # Query based on https://learn.microsoft.com/en-us/previous-versions/sql/sql-server-2012/ms126314(v=sql.110)\n    dbs = self.query_dax(COMMAND_TEMPLATES[\"list_dbs.xml\"].render())\n    return [BaseTabularModel(row[\"CATALOG_NAME\"], self) for row in dbs]\n</code></pre>"},{"location":"SSAS/infra/local_server/","title":"Local SSAS Server","text":"<p>               Bases: <code>BaseServer</code></p> <p>A Server running locally on the user's machine.</p> <p>This subclass has the ability to load/dump Tabular Models to a PBIX file. Also creates a background SSAS instance and workspace to handle processing if none is provided.</p> <p>Parameters:</p> Name Type Description Default <code>kill_on_exit</code> <code>bool</code> <p>Indicates if the background SSAS instance handling processing should be terminated at the end of the python session</p> <code>True</code> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>class LocalServer(BaseServer):\n    \"\"\"A Server running locally on the user's machine.\n\n    This subclass has the ability to load/dump Tabular Models\n    to a PBIX file. Also creates a background SSAS instance and workspace to handle processing if none is provided.\n\n    Args:\n        kill_on_exit (bool): Indicates if the background SSAS instance handling\n            processing should be terminated at the end of the python session\n\n    \"\"\"\n\n    physical_process: SSASProcess\n    \"\"\"\n    A Python class handling the lifetime of the SSAS Instance. Interacts with the SSAS instance only as a process\n    \"\"\"\n\n    def __init__(\n        self,\n        host: str = \"localhost\",\n        workspace_directory: \"StrPath | None\" = None,\n        pid: int | None = None,\n        *,\n        kill_on_exit: bool = True,\n    ) -&gt; None:\n        if pid is not None:\n            self.physical_process = SSASProcess(pid=pid, kill_on_exit=kill_on_exit, startup_config=None)\n        else:\n            startup_config = get_startup_config()\n            workspace_directory = workspace_directory or (\n                startup_config.workspace_dir / datetime.now(UTC).strftime(DT_FORMAT)\n            )\n            self.physical_process = SSASProcess(\n                workspace_directory=workspace_directory,\n                kill_on_exit=kill_on_exit,\n                startup_config=startup_config,\n            )\n        super().__init__(host, self.physical_process.port)\n\n    def load_pbix(self, path: \"StrPath\", *, db_name: str | None = None) -&gt; LocalTabularModel:\n        \"\"\"Takes a Path to a PBIX report and loads the PBIX Datamodel to the SSAS instance in the SSASProcess.\n\n        Raises:\n            FileNotFoundError: when the path to the PBIX file does not exist\n            AdomdErrorResponseException: Occurs when the DB already exists\n\n        \"\"\"\n        path = pathlib.Path(path)\n        if not path.exists():\n            msg = f\"The path to the PBIX does not exist: {path.absolute().as_posix()}\"\n            raise FileNotFoundError(msg)\n        if db_name is None:\n            db_name = path.stem\n        db_name = self.remove_invalid_db_name_chars(db_name)\n        load_command = COMMAND_TEMPLATES[\"image_load.xml\"].render(\n            db_name=db_name,\n            source_path=self.sanitize_xml(path.absolute().as_posix()),\n        )\n        try:\n            self.query_xml(load_command)\n        except pbi_pyadomd.AdomdErrorResponseException as e:\n            if (\n                \"user does not have permission to restore the database, or the database already exists and AllowOverwrite is not specified\"  # noqa: E501\n                in str(e.Message)\n            ):\n                logger.warning(\"Removing old version of PBIX data model for new version\", db_name=db_name)\n                self.query_xml(COMMAND_TEMPLATES[\"db_delete.xml\"].render(db_name=db_name))\n                self.query_xml(load_command)\n            else:\n                raise pbi_pyadomd.AdomdErrorResponseException from e\n\n        self.default_db = db_name  # needed so the DAX queries are pointed to the right DB by defauilt\n        logger.info(\"Tabular Model load complete\")\n        tab_model = LocalTabularModel(db_name=db_name, server=self, pbix_path=path)\n        tab_model.sync_from()\n        return tab_model\n\n    def save_pbix(self, path: \"StrPath\", db_name: str) -&gt; None:\n        path = pathlib.Path(path)\n        self.query_xml(\n            COMMAND_TEMPLATES[\"image_save.xml\"].render(\n                db_name=db_name,\n                target_path=self.sanitize_xml(path.absolute().as_posix()),\n            ),\n        )\n\n    def __repr__(self) -&gt; str:\n        return f\"LocalServer(port={self.port})\"\n</code></pre>"},{"location":"SSAS/infra/local_server/#pbi_core.ssas.server.server.LocalServer.physical_process","title":"physical_process  <code>instance-attribute</code>","text":"<pre><code>physical_process: SSASProcess\n</code></pre> <p>A Python class handling the lifetime of the SSAS Instance. Interacts with the SSAS instance only as a process</p>"},{"location":"SSAS/infra/local_server/#pbi_core.ssas.server.server.LocalServer.load_pbix","title":"load_pbix","text":"<pre><code>load_pbix(path: StrPath, *, db_name: str | None = None) -&gt; LocalTabularModel\n</code></pre> <p>Takes a Path to a PBIX report and loads the PBIX Datamodel to the SSAS instance in the SSASProcess.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>when the path to the PBIX file does not exist</p> <code>AdomdErrorResponseException</code> <p>Occurs when the DB already exists</p> Source code in <code>pbi_core/ssas/server/server.py</code> <pre><code>def load_pbix(self, path: \"StrPath\", *, db_name: str | None = None) -&gt; LocalTabularModel:\n    \"\"\"Takes a Path to a PBIX report and loads the PBIX Datamodel to the SSAS instance in the SSASProcess.\n\n    Raises:\n        FileNotFoundError: when the path to the PBIX file does not exist\n        AdomdErrorResponseException: Occurs when the DB already exists\n\n    \"\"\"\n    path = pathlib.Path(path)\n    if not path.exists():\n        msg = f\"The path to the PBIX does not exist: {path.absolute().as_posix()}\"\n        raise FileNotFoundError(msg)\n    if db_name is None:\n        db_name = path.stem\n    db_name = self.remove_invalid_db_name_chars(db_name)\n    load_command = COMMAND_TEMPLATES[\"image_load.xml\"].render(\n        db_name=db_name,\n        source_path=self.sanitize_xml(path.absolute().as_posix()),\n    )\n    try:\n        self.query_xml(load_command)\n    except pbi_pyadomd.AdomdErrorResponseException as e:\n        if (\n            \"user does not have permission to restore the database, or the database already exists and AllowOverwrite is not specified\"  # noqa: E501\n            in str(e.Message)\n        ):\n            logger.warning(\"Removing old version of PBIX data model for new version\", db_name=db_name)\n            self.query_xml(COMMAND_TEMPLATES[\"db_delete.xml\"].render(db_name=db_name))\n            self.query_xml(load_command)\n        else:\n            raise pbi_pyadomd.AdomdErrorResponseException from e\n\n    self.default_db = db_name  # needed so the DAX queries are pointed to the right DB by defauilt\n    logger.info(\"Tabular Model load complete\")\n    tab_model = LocalTabularModel(db_name=db_name, server=self, pbix_path=path)\n    tab_model.sync_from()\n    return tab_model\n</code></pre>"},{"location":"SSAS/infra/commands/blank_model/","title":"Blank model","text":"<p>The XMLA used to create a blank model in SSAS.</p> <pre><code>&lt;Batch xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"&gt;\n  &lt;Create AllowOverwrite=\"true\" xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"&gt;\n    &lt;ObjectDefinition&gt;\n      &lt;Database xmlns:ddl200_200=\"http://schemas.microsoft.com/analysisservices/2010/engine/200/200\" xmlns:ddl200=\"http://schemas.microsoft.com/analysisservices/2010/engine/200\"&gt;\n        &lt;ID&gt;{{db_name}}&lt;/ID&gt;\n        &lt;Name&gt;{{db_name}}&lt;/Name&gt;\n        &lt;ddl200_200:StorageEngineUsed&gt;TabularMetadata&lt;/ddl200_200:StorageEngineUsed&gt;\n        &lt;ddl200:CompatibilityLevel&gt;1550&lt;/ddl200:CompatibilityLevel&gt;\n      &lt;/Database&gt;\n    &lt;/ObjectDefinition&gt;\n  &lt;/Create&gt;\n&lt;/Batch&gt;\n</code></pre>"},{"location":"SSAS/infra/commands/db_delete/","title":"Db delete","text":"<p>The command to delete a database in SSAS. </p> <p>Tip</p> <p>By default, PowerBI desktop uses a temporary database for each <code>.pbix</code> file. By contrast, <code>pbi_core</code> tries to use a persistent database for each project. Because of this, you may need to delete the database to avoid wasting old databases. <code>pbi_core</code> will try to automatically delete the database on exit, but you can also delete it manually using this command.</p> <pre><code>&lt;Delete xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"&gt;\n  &lt;Object&gt; \n    &lt;DatabaseID&gt;{{db_name}}&lt;/DatabaseID&gt;\n  &lt;/Object&gt;\n&lt;/Delete&gt;\n</code></pre>"},{"location":"SSAS/infra/commands/discover_schema/","title":"Discover schema","text":"<p>This large command is used to <code>discover</code> the schema of a database in SQL Server Analysis Services (SSAS). It retrieves all available metadata about the entities in the associated PowerBI model.</p> <pre><code>&lt;Batch Transaction=\"false\" xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_MODEL&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_DATA_SOURCES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_TABLES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_COLUMNS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_ATTRIBUTE_HIERARCHIES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PARTITIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_RELATIONSHIPS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_MEASURES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_HIERARCHIES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_LEVELS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_ANNOTATIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_KPIS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_CULTURES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_OBJECT_TRANSLATIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_LINGUISTIC_METADATA&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVE_TABLES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVE_COLUMNS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVE_HIERARCHIES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVE_MEASURES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_ROLES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_ROLE_MEMBERSHIPS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_TABLE_PERMISSIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_VARIATIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_SETS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_PERSPECTIVE_SETS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_EXTENDED_PROPERTIES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_EXPRESSIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_COLUMN_PERMISSIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_DETAIL_ROWS_DEFINITIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_RELATED_COLUMN_DETAILS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_GROUP_BY_COLUMNS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_CALCULATION_GROUPS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_CALCULATION_ITEMS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_ALTERNATE_OF_DEFINITIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_REFRESH_POLICIES&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_FORMAT_STRING_DEFINITIONS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;TMSCHEMA_QUERY_GROUPS&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n    &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n        &lt;RequestType&gt;DISCOVER_CALC_DEPENDENCY&lt;/RequestType&gt;\n        &lt;Restrictions&gt;\n            &lt;RestrictionList&gt;\n                &lt;DATABASE_NAME&gt;{{db_name}}&lt;/DATABASE_NAME&gt;\n            &lt;/RestrictionList&gt;\n        &lt;/Restrictions&gt;\n        &lt;Properties&gt;\n            &lt;PropertyList/&gt;\n        &lt;/Properties&gt;\n    &lt;/Discover&gt;\n&lt;/Batch&gt;\n</code></pre>"},{"location":"SSAS/infra/commands/image_load/","title":"Image load","text":"<p>This command is used to load a PowerBI data model to SSAS from a pbix file. <pre><code>&lt;ImageLoad \n  xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\" \n  xmlns:ddl100=\"http://schemas.microsoft.com/analysisservices/2008/engine/100\" \n  xmlns:ddl200=\"http://schemas.microsoft.com/analysisservices/2010/engine/200\" \n  xmlns:ddl700_700=\"http://schemas.microsoft.com/analysisservices/2018/engine/700/700\"\n&gt;\n  &lt;ddl700_700:PackagePath&gt;{{source_path}}&lt;/ddl700_700:PackagePath&gt;\n  &lt;ddl700_700:PackagePartUri&gt;/DataModel&lt;/ddl700_700:PackagePartUri&gt;\n  &lt;DatabaseName&gt;{{db_name}}&lt;/DatabaseName&gt;\n  &lt;DatabaseID&gt;{{db_name}}&lt;/DatabaseID&gt;\n  &lt;ddl100:ReadWriteMode&gt;ReadWrite&lt;/ddl100:ReadWriteMode&gt;\n&lt;/ImageLoad&gt;\n</code></pre></p>"},{"location":"SSAS/infra/commands/image_save/","title":"Image save","text":"<p>This command is used to save a PowerBI data model from SSAS to a pbix file. <pre><code>&lt;ImageSave\n    xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"\n    xmlns:ddl100=\"http://schemas.microsoft.com/analysisservices/2008/engine/100\"\n    xmlns:ddl200=\"http://schemas.microsoft.com/analysisservices/2010/engine/200\"\n    xmlns:ddl700_700=\"http://schemas.microsoft.com/analysisservices/2018/engine/700/700\"\n&gt;\n    &lt;ddl700_700:PackagePath&gt;{{target_path}}&lt;/ddl700_700:PackagePath&gt;\n    &lt;ddl700_700:PackagePartUri&gt;/DataModel&lt;/ddl700_700:PackagePartUri&gt;\n    &lt;Object&gt;\n        &lt;DatabaseID&gt;{{db_name}}&lt;/DatabaseID&gt;\n    &lt;/Object&gt;\n&lt;/ImageSave&gt;\n</code></pre></p>"},{"location":"SSAS/infra/commands/list_dbs/","title":"List dbs","text":"<p>This command lists all the databases in the SSAS instance. It is useful for checking which databases are available before performing operations like loading or saving a PowerBI model or to identify databases that may need to be deleted.</p> <pre><code>&lt;Batch Transaction=\"false\" xmlns=\"http://schemas.microsoft.com/analysisservices/2003/engine\"&gt;\n  &lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n    &lt;RequestType&gt;DBSCHEMA_CATALOGS&lt;/RequestType&gt;\n    &lt;Restrictions /&gt;\n    &lt;Properties /&gt;\n  &lt;/Discover&gt;\n&lt;/Batch&gt;\n</code></pre>"},{"location":"general/ecosystem/","title":"Power BI Libraries Overview","text":"<p>pbi_core: The main library. This library provides the core functionality for working with Power BI reports. It can: - Independently create an SSAS backend and load a Power BI report file (.pbix), allowing for programmatic manipulation of Power BI reports. - Run performance traces and extract the data for visuals, measures, columns, and tables in the Power BI report. - Provides a full Pydantic model for the Power BI layout. </p> <p>pbi_parsers: A library that provides parsers for the DAX and M Query languages used in Power BI. This library allows deeper introspection of the queries used in a report. It also implements basic auto-formatting for DAX queries.</p> <p>pbi_translation: A simple library providing an interface to translate the VisualContainers' Prototype Query to DAX Query. It uses the same library as the PowerBI Desktop to ensure that the DAX Query is identical to the one generated by PowerBI Desktop. This library is used by the pbi_core library to convert the Prototype Query to DAX Query. Please refer to the flowchart below for the process of populating data in Power BI visuals.</p> <p>pbi_ruff: Currently residing in the pbi_core repository, this is a collection of ruff-style rules for Power BI reports. Rules are used to ensure that Power BI reports follow best practices and maintainability standards. Rules are applied to the layout, DAX, and PowerQuery entities in the Power BI report.</p> <p>pbi_pyadomd: A fork of the original pyadomd library, which is a Python client for the Microsoft Analysis Services Tabular Data Model. Adds logging, more typing at the C# and python level, and some additional features such as support for streaming results. Additions were done to support various downstream libraries.</p> <p>pbi_gui: A graphical user interface for the PBI_CORE library, providing a user-friendly way to interact with the functionality of the PBI_CORE and pbi_ruff libraries. </p> <p>pbi_server: A server that provides a REST API for the pbi_core library, allowing for remote access to the functionality of the pbi_core and pbi_ruff libraries. The server is designed to be used in conjunction with the pbi_gui library, but can also be used independently.</p> <p>In the following flowchart:</p> <ul> <li>Packages in green are considered feature complete and essentially stable.</li> <li>Packages in orange are in active development, but should be usable for most basic scenarios.</li> <li>Packages in red are experimental and are recommended only for advanced users or contributors.</li> </ul> <pre><code>flowchart TD\n\n    style pbi_server stroke:red\n    style pbi_gui stroke:red\n    style pbi_core stroke:orange\n    style pbi_ruff stroke:red\n    style pbi_pyadomd stroke:green\n    style pbi_translation stroke:green\n    style pbi_parsers stroke:green\n    style pbi_git stroke:orange\n\n\n    pbi_git -- Uses to compare reports --&gt; pbi_core\n    pbi_gui -- Uses as a REST API --&gt; pbi_server\n    pbi_server -- Uses to retrieve data from reports --&gt; pbi_core\n    pbi_server -- Uses to identify issues in reports --&gt; pbi_ruff\n    pbi_ruff -- Uses to retrieve data from reports --&gt; pbi_core\n    pbi_core -- Used to connect with SSAS backend --&gt; pbi_pyadomd\n    pbi_core -- Uses to translate Prototype Query to DAX Query --&gt; pbi_translation\n    pbi_ruff -- Uses to introspect DAX and M Queries --&gt; pbi_parsers</code></pre>"},{"location":"general/ecosystem/#populating-data-in-power-bi-visuals","title":"Populating Data in Power BI Visuals","text":"<p>Given this library's focus on Power BI and its data model, it is important to understand how data is populated in Power BI visuals from a <code>pbix</code> file. The following sequence diagram illustrates the process:</p> <ul> <li><code>PowerBI Libs</code> are the various libraries used by the Power BI GUI (both on Desktop and in <code>app.powerbi.com</code>)to interact with the SSAS backend. These are largely invisible to the user.</li> <li><code>Front End</code> is the Power BI GUI, which is responsible for rendering the visuals and interacting with the user. This is the Desktop application or the web application itself.</li> <li><code>SSAS Backend</code> is the Analysis Services Tabular Data Model that stores the data model and executes DAX queries.</li> </ul> <pre><code>sequenceDiagram\n    Front End-&gt;&gt; PowerBI Libs: Requests a report to be loaded from a `pbix` file\n    PowerBI Libs-&gt;&gt; Front End: Initializes Frontend from Layout JSON in the `pbix` file\n    PowerBI Libs-&gt;&gt; SSAS Backend: Initializes Backend from Datamodel blob in the `pbix` file\n    SSAS Backend-&gt;&gt; Front End: Returns connection info to loaded Data Model\n    Front End-&gt;&gt; PowerBI Libs: Requests conversion of the Prototype Query to DAX Query matching the data model found in the SSAS Backend\n    PowerBI Libs-&gt;&gt; Front End: Returns DAX Query\n    Front End-&gt;&gt; SSAS Backend: Executes DAX Query\n    SSAS Backend-&gt;&gt; Front End: Returns Data\n    Front End-&gt;&gt; Front End: Populates Visuals with Data</code></pre>"},{"location":"general/goals/","title":"Project Goals","text":"<p>Goals of this package:</p> <ul> <li> Data/Visual Lineage Tool<ul> <li> Low-level SSAS interface for updating PBIX Data Models</li> <li> Low-level interface for updating Static PBIX elements</li> <li> Intra-SSAS lineage</li> <li> Intra-layout lineage</li> <li> Layout-SSAS lineage</li> </ul> </li> <li> AST parser for DAX Queries</li> <li> AST parser for M Queries</li> <li> Automatic Data Refresh<ul> <li> with Desktop PBIX SSAS</li> <li> with self-created SSAS</li> </ul> </li> <li> Automated Data Extraction<ul> <li> At the Column Level</li> <li> At the Table Level</li> <li> At the Measure Level</li> <li> At the Visual Level</li> </ul> </li> <li> Automated Performance Testing<ul> <li> At the Column Level</li> <li> At the Table Level</li> <li> At the Measure Level</li> <li> At the Visual Level</li> </ul> </li> <li> Linting Tools<ul> <li> Layout stylistic Linting</li> <li> DAX Formatter</li> <li> DAX Linting</li> <li> M Query Linting</li> </ul> </li> <li> Remote PowerBI Manipulation<ul> <li> Incorporating REST API lib</li> <li> Include non-REST endpoints</li> <li> Report Deployment</li> <li> Report Download</li> <li> Viewship, etc. statistics</li> </ul> </li> <li> Built-In Data Export Options<ul> <li> To Postgres</li> <li> To SQLite</li> <li> To CSVs</li> </ul> </li> </ul>"},{"location":"general/quick_start/","title":"Quick start","text":""},{"location":"general/quick_start/#basic-functionality","title":"Basic Functionality","text":"<p>This basic example tests that your PowerBI report can be parsed and reassembled by <code>pbi_core</code>. </p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example.pbix\")  # (1)!\nreport.save_pbix(\"example_out.pbix\")  # (1)!\n</code></pre> <ol> <li>hi</li> </ol>"},{"location":"general/quick_start/#altering-data-model","title":"Altering Data model","text":"<p>This example shows how you can add automatic descriptions to PowerBI columns (possibly from some governance tool??)</p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example.pbix\")\nfor column in report.ssas.columns:\n    column.description = \"pbi_core has touched this\"\n    column.alter()  # saves the changes to the SSAS DB\n\nreport.save_pbix(\"example_out.pbix\")\n</code></pre>"},{"location":"general/quick_start/#finding-records-in-ssas-tables","title":"Finding records in SSAS tables","text":"<p>This example shows how to find SSAS records and extract data from report columns</p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example.pbix\")\nvalues = report.ssas.columns.find({\"explicit_name\": \"a\"}).data()\nprint(values)\nvalues2 = report.ssas.tables.find({\"name\": \"Table\"}).data()\nprint(values2)\n\nmeasure = report.ssas.measures.find({\"name\": \"Measure\"})\ncolumn = measure.table().columns()[1]  \n# Note: the first column is a hidden row-count column that can't be used in measures\nvalues3 = measure.data(column, head=10)\nprint(values3)\n</code></pre>"},{"location":"general/quick_start/#pbi_core-lineage-chart","title":"pbi_core Lineage Chart","text":"<p>This example displays a lineage chart in HTML:</p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example.pbix\", kill_ssas_on_exit=True)\ncol = report.ssas.columns.find({\"explicit_name\": \"MeasureColumn\"})\ncol.get_lineage(\"parents\").to_mermaid().show()\n</code></pre>"},{"location":"general/quick_start/#improved-multilanguage-support","title":"Improved Multilanguage Support","text":"<p>This example displays the ability to easily convert PBIX reports to alternate languages:</p> <pre><code>from pbi_core import LocalReport\nfrom pbi_core.misc.internationalization import get_static_elements, set_static_elements\n\nreport = LocalReport.load_pbix(\"example.pbix\", kill_ssas_on_exit=True)\nx = get_static_elements(report.static_files.layout)\nx.to_excel(\"multilang.xlsx\")\n\nset_static_elements(\"multilang1.xlsx\", \"example.pbix\")\n</code></pre>"},{"location":"general/quick_start/#automatic-data-model-cleaning","title":"Automatic Data Model Cleaning","text":"<p>One of the core tensions in PowerBI is the size of the data model. In development, you want to have many measures, columns, and tables to simplify new visual creation. After developing the report, the additional elements create two issues:</p> <ol> <li>It's difficult to understand which elements are being used and how they relate to each other</li> <li>The additional columns and tables can slow down visual rendering times, negatively impacting UX</li> </ol> <p>pbi_core has an automatic element culler that allows you to remove unnecessary elements after the report has been designed:</p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example_pbis/api.pbix\")\nreport.cleanse_ssas_model()\nreport.save_pbix(\"cull_out.pbix\")\n</code></pre>"},{"location":"general/quick_start/#performance-analysis","title":"Performance Analysis","text":"<p>This example shows how to analyze the performance of a Power BI report's visual:</p> <p>Warning</p> <p>In the current implementation, the performance trace occassionally hangs. If this happens, you can kill the process and restart it. This is a known issue that will be fixed in a future release.</p> <pre><code>from pbi_core import LocalReport\n\nreport = LocalReport.load_pbix(\"example_pbis/example_section_visibility.pbix\")\n# x = report.static_files.layout.sections[0].visualContainers[0].get_performance(report.ssas)\nx = report.static_files.layout.sections[0].get_performance(report.ssas)\nprint(x)\nprint(\"=================\")\nprint(x[0].pprint())\n</code></pre> <p>Which generates the following output.</p> <pre><code>2025-07-05 14:07:31 [info     ] Loading PBIX                   path=example_pbis/example_section_visibility.pbix\n2025-07-05 14:07:33 [warning  ] Removing old version of PBIX data model for new version db_name=example_section_visibility\n2025-07-05 14:07:33 [info     ] Tabular Model load complete   \n2025-07-05 14:07:35 [info     ] Beginning trace               \n2025-07-05 14:07:38 [info     ] Running DAX commands          \n2025-07-05 14:07:41 [info     ] Terminating trace             \n[Performance(rows=5, total_duration=0.0, total_cpu_time=0.0, peak_consumption=1.0 MiB]\n=================\nPerformance(\n    Command:\n\n        DEFINE VAR __DS0Core =\n                SUMMARIZECOLUMNS('example'[b], \"Suma\", CALCULATE(SUM('example'[a])))\n\n        EVALUATE\n                __DS0Core\n\n    Start Time: 2025-07-05T19:07:38.450000+00:00\n    End Time: 2025-07-05T19:07:38.453000+00:00\n    Total Duration: 4 ms\n    Total CPU Time: 0 ms\n    Query CPU Time: 0 ms\n    Vertipaq CPU Time: 0 ms\n    Execution Delay: 0 ms\n    Approximate Peak Consumption: 1.0 MiB\n    Rows Returned: 5\n)\n</code></pre>"},{"location":"general/setup/","title":"Initial Setup","text":"<p>To ensure that the pbi_core library references the correct Power BI dependencies consistently and with minimal required permissions, it includes a script to copy files from the Power BI installation directories to the pbi_core library directory. This setup is necessary because Power BI does not provide a public API for accessing these files, and the library needs to reference them directly. Additionally, in some local installations, the Power BI installation directory may require administrative permissions to access.</p> <p>To setup, run the following command:</p> <pre><code>run `python -m pbi_core setup`\n</code></pre> <p>If the setup cannot find a file, you can generally find the folder by typing \"PowerBI\" into the startup menu, then open in file folder, and then following the shortcut link.</p>"},{"location":"layout/layout/","title":"Layout","text":"<p>               Bases: <code>LayoutNode</code></p> <p>Represents the layout of a Power BI report, including sections, filters, and other properties.</p> Source code in <code>pbi_core/static_files/layout/layout.py</code> <pre><code>class Layout(LayoutNode):\n    \"\"\"Represents the layout of a Power BI report, including sections, filters, and other properties.\"\"\"\n\n    id: int = -3\n    reportId: int = -1\n    filters: Json[list[GlobalFilter]] = []\n    resourcePackages: list[ResourcePackage]\n    sections: list[Section]\n    config: Json[LayoutConfig]\n    layoutOptimization: LayoutOptimization\n    theme: str | None = None\n    pods: list[Pod] = []\n    publicCustomVisuals: list[PublicCustomVisual] = []\n    _xpath = []\n\n    def pbi_core_name(self) -&gt; str:  # noqa: PLR6301\n        return \"Layout\"\n\n    def get_ssas_elements(\n        self,\n        *,\n        include_sections: bool = True,\n        include_filters: bool = True,\n    ) -&gt; set[ModelColumnReference | ModelMeasureReference]:\n        \"\"\"Returns the SSAS elements (columns and measures) this report is directly dependent on.\"\"\"\n        ret: set[ModelColumnReference | ModelMeasureReference] = set()\n        if include_filters:\n            for f in self.filters:\n                ret.update(f.get_ssas_elements())\n        if include_sections:\n            for s in self.sections:\n                ret.update(s.get_ssas_elements())\n        return ret\n\n    def get_lineage(\n        self,\n        lineage_type: Literal[\"children\", \"parents\"],\n        tabular_model: \"BaseTabularModel\",\n    ) -&gt; LineageNode:\n        if lineage_type == \"children\":\n            return LineageNode(self, lineage_type)\n\n        entities = self.get_ssas_elements()\n        children_nodes = [ref.to_model(tabular_model) for ref in entities]\n\n        children_lineage = [p.get_lineage(lineage_type) for p in children_nodes if p is not None]\n        return LineageNode(self, lineage_type, children_lineage)\n</code></pre>"},{"location":"layout/layout/#pbi_core.static_files.layout.Layout.get_ssas_elements","title":"get_ssas_elements","text":"<pre><code>get_ssas_elements(*, include_sections: bool = True, include_filters: bool = True) -&gt; set[ModelColumnReference | ModelMeasureReference]\n</code></pre> <p>Returns the SSAS elements (columns and measures) this report is directly dependent on.</p> Source code in <code>pbi_core/static_files/layout/layout.py</code> <pre><code>def get_ssas_elements(\n    self,\n    *,\n    include_sections: bool = True,\n    include_filters: bool = True,\n) -&gt; set[ModelColumnReference | ModelMeasureReference]:\n    \"\"\"Returns the SSAS elements (columns and measures) this report is directly dependent on.\"\"\"\n    ret: set[ModelColumnReference | ModelMeasureReference] = set()\n    if include_filters:\n        for f in self.filters:\n            ret.update(f.get_ssas_elements())\n    if include_sections:\n        for s in self.sections:\n            ret.update(s.get_ssas_elements())\n    return ret\n</code></pre>"},{"location":"powerbi_references/SSAS_Architecture/","title":"SSAS Architecture","text":""},{"location":"powerbi_references/SSAS_Architecture/#xmla-commands-between-power-bi-and-ssas","title":"XMLA Commands Between Power BI and SSAS","text":"<p>Power BI uses XMLA (XML for Analysis) commands to communicate with SQL Server Analysis Services (SSAS). These commands are essential for querying, managing, and interacting with SSAS data models. Below is a detailed explanation of the specific XMLA commands sent between Power BI files (<code>.pbix</code>) and SSAS, along with examples.</p>"},{"location":"powerbi_references/SSAS_Architecture/#common-xmla-commands","title":"Common XMLA Commands","text":"<ol> <li>DISCOVER:</li> <li>Used to retrieve metadata about the SSAS model, such as available tables, measures, and hierarchies.      <pre><code>&lt;Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n  &lt;RequestType&gt;DISCOVER_SCHEMA_ROWSETS&lt;/RequestType&gt;\n  &lt;Restrictions /&gt;\n  &lt;Properties&gt;\n    &lt;PropertyList&gt;\n      &lt;Catalog&gt;AdventureWorks&lt;/Catalog&gt;\n    &lt;/PropertyList&gt;\n  &lt;/Properties&gt;\n&lt;/Discover&gt;\n</code></pre></li> <li> <p>Output Example:      <pre><code>&lt;root&gt;\n  &lt;row&gt;\n    &lt;TABLE_NAME&gt;Sales&lt;/TABLE_NAME&gt;\n    &lt;MEASURE_NAME&gt;Sales Amount&lt;/MEASURE_NAME&gt;\n    &lt;HIERARCHY_NAME&gt;Calendar Year&lt;/HIERARCHY_NAME&gt;\n  &lt;/row&gt;\n  &lt;row&gt;\n    &lt;TABLE_NAME&gt;Products&lt;/TABLE_NAME&gt;\n    &lt;MEASURE_NAME&gt;Product Count&lt;/MEASURE_NAME&gt;\n    &lt;HIERARCHY_NAME&gt;Category&lt;/HIERARCHY_NAME&gt;\n  &lt;/row&gt;\n&lt;/root&gt;\n</code></pre></p> </li> <li> <p>EXECUTE:</p> </li> <li>Used to execute MDX (Multidimensional Expressions) or DAX (Data Analysis Expressions) queries against the SSAS model.      <pre><code>&lt;Execute xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n  &lt;Command&gt;\n    &lt;Statement&gt;\n      EVALUATE SUMMARIZE(\n        Sales,\n        \"Year\", Sales[Calendar Year],\n        \"Total Sales\", SUM(Sales[Sales Amount])\n      )\n    &lt;/Statement&gt;\n  &lt;/Command&gt;\n  &lt;Properties&gt;\n    &lt;PropertyList&gt;\n      &lt;Catalog&gt;AdventureWorks&lt;/Catalog&gt;\n    &lt;/PropertyList&gt;\n  &lt;/Properties&gt;\n&lt;/Execute&gt;\n</code></pre></li> <li> <p>Output Example:      <pre><code>&lt;root&gt;\n  &lt;row&gt;\n    &lt;Year&gt;2020&lt;/Year&gt;\n    &lt;Total Sales&gt;100000&lt;/Total Sales&gt;\n  &lt;/row&gt;\n  &lt;row&gt;\n    &lt;Year&gt;2021&lt;/Year&gt;\n    &lt;Total Sales&gt;150000&lt;/Total Sales&gt;\n  &lt;/row&gt;\n&lt;/root&gt;\n</code></pre></p> </li> <li> <p>PROCESS:</p> </li> <li>Used to refresh SSAS objects, such as tables or partitions, ensuring that data is up-to-date.      <pre><code>&lt;Process xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n  &lt;Type&gt;ProcessFull&lt;/Type&gt;\n  &lt;Object&gt;\n    &lt;DatabaseID&gt;AdventureWorks&lt;/DatabaseID&gt;\n    &lt;CubeID&gt;Sales&lt;/CubeID&gt;\n  &lt;/Object&gt;\n&lt;/Process&gt;\n</code></pre></li> <li> <p>Output Example:      <pre><code>&lt;root&gt;\n  &lt;ProcessResult&gt;\n    &lt;Status&gt;Success&lt;/Status&gt;\n    &lt;Message&gt;Data refreshed successfully.&lt;/Message&gt;\n  &lt;/ProcessResult&gt;\n&lt;/root&gt;\n</code></pre></p> </li> <li> <p>ALTER:</p> </li> <li>Used to modify SSAS objects, such as updating the schema or changing properties.      <pre><code>&lt;Alter xmlns=\"urn:schemas-microsoft-com:xml-analysis\"&gt;\n  &lt;Object&gt;\n    &lt;DatabaseID&gt;AdventureWorks&lt;/DatabaseID&gt;\n    &lt;CubeID&gt;Sales&lt;/CubeID&gt;\n  &lt;/Object&gt;\n  &lt;ObjectDefinition&gt;\n    &lt;Cube&gt;\n      &lt;Name&gt;Sales&lt;/Name&gt;\n      &lt;Description&gt;Updated Sales Cube&lt;/Description&gt;\n    &lt;/Cube&gt;\n  &lt;/ObjectDefinition&gt;\n&lt;/Alter&gt;\n</code></pre></li> <li>Output Example:      <pre><code>&lt;root&gt;\n  &lt;AlterResult&gt;\n    &lt;Status&gt;Success&lt;/Status&gt;\n    &lt;Message&gt;Schema updated successfully.&lt;/Message&gt;\n  &lt;/AlterResult&gt;\n&lt;/root&gt;\n</code></pre></li> </ol>"},{"location":"powerbi_references/SSAS_Architecture/#workflow-of-xmla-commands-in-power-bi","title":"Workflow of XMLA Commands in Power BI","text":"<ol> <li>Initialization:</li> <li> <p>When a Power BI file connects to SSAS, it sends a <code>DISCOVER</code> command to retrieve metadata about the data model.</p> </li> <li> <p>Query Execution:</p> </li> <li> <p>Power BI sends <code>EXECUTE</code> commands to fetch data based on user-defined queries or visualizations.</p> </li> <li> <p>Data Refresh:</p> </li> <li> <p>During scheduled refreshes, Power BI may send <code>PROCESS</code> commands to ensure the SSAS model is updated.</p> </li> <li> <p>Model Updates:</p> </li> <li>If changes are made to the SSAS model, Power BI can send <code>ALTER</code> commands to apply updates.</li> </ol>"},{"location":"powerbi_references/SSAS_Architecture/#interaction-diagram-power-bi-desktop-and-ssas","title":"Interaction Diagram: Power BI Desktop and SSAS","text":"<p>Below is a mermaid diagram illustrating the flow of XMLA commands between Power BI Desktop and SSAS:</p> <pre><code>sequenceDiagram\n    participant PBI as Power BI Desktop\n    participant SSAS as SQL Server Analysis Services\n\n    PBI-&gt;&gt;SSAS: IMAGE LOAD\n    SSAS--&gt;&gt;PBI: SSAS Creates a database based on the DataModel in the `pbix` file. Returns Confirmation of process.  \n\n    PBI-&gt;&gt;SSAS: DISCOVER\n    SSAS--&gt;&gt;PBI: Metadata (Tables, Measures, Hierarchies)\n\n    PBI-&gt;&gt;SSAS: EXECUTE (MDX/DAX Query)\n    SSAS--&gt;&gt;PBI: Query Results\n\n    PBI-&gt;&gt;SSAS: PROCESS (Refresh Data)\n    SSAS--&gt;&gt;PBI: Confirmation\n\n    PBI-&gt;&gt;SSAS: ALTER (Update Schema)\n    SSAS--&gt;&gt;PBI: Confirmation\n\n    PBI-&gt;&gt;SSAS: IMAGE SAVE\n    SSAS--&gt;&gt;PBI: SSAS saves the database to the DataModel embedded in the `pbix` file. Returns Confirmation of process.  </code></pre> <p>This diagram visually represents the communication between Power BI Desktop and SSAS, highlighting the key XMLA commands and their responses.</p>"},{"location":"powerbi_references/layout_architecture/","title":"Layout JSON","text":"<p>The layout JSON file defines the structure and arrangement of visual elements within a report. Below is a description of its primary elements and their purpose.</p>"},{"location":"powerbi_references/layout_architecture/#primary-elements","title":"Primary Elements","text":""},{"location":"powerbi_references/layout_architecture/#1-sections","title":"1. Sections","text":"<ul> <li>Purpose: Represents individual pages or tabs within a Power BI report.</li> <li>Key Properties:</li> <li><code>name</code>: The name of the section.</li> <li><code>displayName</code>: The user-friendly name displayed in the report.</li> <li><code>visualContainers</code>: A collection of visual elements (charts, tables, etc.) contained within the section.</li> </ul>"},{"location":"powerbi_references/layout_architecture/#2-visualcontainers","title":"2. VisualContainers","text":"<ul> <li>Purpose: Defines the individual visual elements within a section.</li> <li>Key Properties:</li> <li><code>x</code>, <code>y</code>: Coordinates specifying the position of the visual on the page.</li> <li><code>width</code>, <code>height</code>: Dimensions of the visual.</li> <li><code>config</code>: Configuration settings for the visual, including data bindings and formatting.</li> </ul>"},{"location":"powerbi_references/layout_architecture/#3-filters","title":"3. Filters","text":"<ul> <li>Purpose: Specifies filters applied to the report or individual visuals.</li> <li>Key Properties:</li> <li><code>filterType</code>: The type of filter (e.g., basic, advanced).</li> <li><code>filterValues</code>: The values used for filtering.</li> </ul>"},{"location":"powerbi_references/layout_architecture/#4-bookmarks","title":"4. Bookmarks","text":"<ul> <li>Purpose: Represents saved states of the report, allowing users to switch between predefined views.</li> <li>Key Properties:</li> <li><code>name</code>: The name of the bookmark.</li> <li><code>displayName</code>: The user-friendly name displayed in the report.</li> <li><code>state</code>: The state of the report when the bookmark is applied.</li> </ul>"},{"location":"powerbi_references/layout_architecture/#5-settings","title":"5. Settings","text":"<ul> <li>Purpose: Contains global settings for the report layout.</li> <li>Key Properties:</li> <li><code>theme</code>: The theme applied to the report.</li> <li><code>gridSettings</code>: Settings for the grid layout, including spacing and alignment.</li> </ul>"},{"location":"ruff/main/","title":"Ruff Rule Groups","text":"Group Name Rule Count DAX Formatting Rules 5 DAX Performance Rules 1 Layout Rules 2 Section Rules 3 Theme Rules 4 Visual Rules 1"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/","title":"DAX Formatting Rules","text":"<p>Group of rules related to DAX formatting.</p>"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/#dax-001-camel-case-variable-names","title":"DAX-001: Camel Case Variable Names","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Variable names in DAX expressions should be in camelCase format.\nThis helps maintain consistency and readability in DAX expressions.\n</code></pre>"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/#dax-002-camel-case-measure-names","title":"DAX-002: Camel Case Measure Names","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Measure names in DAX expressions should be in camelCase format.\nThis helps maintain consistency and readability in DAX expressions.\n</code></pre>"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/#dax-003-unused-measure-variables","title":"DAX-003: Unused Measure Variables","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Measures should not contain unused variables.\nThis helps maintain clarity and (in some cases?) performance in DAX expressions.\n</code></pre>"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/#dax-004-magic-numbers-in-dax-expressions","title":"DAX-004: Magic Numbers in DAX Expressions","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>DAX expressions should not contain magic numbers.\nMagic numbers are numeric literals that appear in the code without explanation.\nThey can make the code harder to understand and maintain.\nIf the number is used multiple times, it should be assigned to a measure. If it is used only once,\nit should be assigned to a variable with a descriptive name.\n\nBasic numbers: (1, 2, 3, 7, 30, 100, 1000) are excluded from this rule.\n</code></pre>"},{"location":"ruff/rule_groups/DAX_Formatting_Rules/#dax-007-capitalize-function-names","title":"DAX-007: Capitalize Function Names","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Function names in DAX expressions should be upper case.\nThis helps maintain consistency and readability in DAX expressions.\n</code></pre>"},{"location":"ruff/rule_groups/DAX_Performance_Rules/","title":"DAX Performance Rules","text":"<p>Group of rules related to DAX performance.</p>"},{"location":"ruff/rule_groups/DAX_Performance_Rules/#dax-006-literals-in-calculate","title":"DAX-006: Literals in CALCULATE","text":"<p>Applies to:</p> <ul> <li>Measure</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>CALCULATE expressions should not contain number/string literals.\nThis helps maintain clarity and performance in DAX expressions.\n</code></pre>"},{"location":"ruff/rule_groups/Layout_Rules/","title":"Layout Rules","text":"<p>Group of rules related to the overall layout.</p>"},{"location":"ruff/rule_groups/Layout_Rules/#gen-001-consistent-font","title":"GEN-001: Consistent Font","text":"<p>Applies to:</p> <ul> <li>Layout</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>No more than 2 fonts should be used in a report\n</code></pre>"},{"location":"ruff/rule_groups/Layout_Rules/#gen-002-consistent-title","title":"GEN-002: Consistent Title","text":"<p>Applies to:</p> <p>No sources specified</p> <p>Fix State: Not Automatically Fixable</p> <pre><code>All Sections should have a title in the top left quadrant of the report.\nA title should be a text box visual.\n</code></pre>"},{"location":"ruff/rule_groups/Section_Rules/","title":"Section Rules","text":"<p>Group of rules related to sections.</p>"},{"location":"ruff/rule_groups/Section_Rules/#sec-001-x-axis-visual-alignment","title":"SEC-001: X-axis Visual Alignment","text":"<p>Applies to:</p> <ul> <li>Section</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>No visual should have its x-axis misaligned with other visuals in the\n    same section by less than 10 pixel.\n</code></pre>"},{"location":"ruff/rule_groups/Section_Rules/#sec-002-y-axis-visual-alignment","title":"SEC-002: Y-axis Visual Alignment","text":"<p>Applies to:</p> <ul> <li>Section</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>No visual should have its x-axis misaligned with other visuals in the\n    same section by less than 10 pixel.\n</code></pre>"},{"location":"ruff/rule_groups/Section_Rules/#sec-003-section-naming","title":"SEC-003: Section Naming","text":"<p>Applies to:</p> <ul> <li>Section</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Section names should be human readable. This means no underscores, capital case usage, and less than 35 characters (the max Power BI allows before using ellipses).\n</code></pre>"},{"location":"ruff/rule_groups/Theme_Rules/","title":"Theme Rules","text":"<p>Group of rules related to theme colors.</p>"},{"location":"ruff/rule_groups/Theme_Rules/#thm-001-theme-colors","title":"THM-001: Theme Colors","text":"<p>Applies to:</p> <ul> <li>Theme</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>All colors used in the report should be defined in the theme.\nThis helps to maintain consistency and makes it easier to change colors later.\n</code></pre>"},{"location":"ruff/rule_groups/Theme_Rules/#thm-002-theme-colors-protanopia","title":"THM-002: Theme Colors Protanopia","text":"<p>Applies to:</p> <ul> <li>Theme</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>All data colors should be clearly distinguishable for color vision deficiency.\nThis rule is specifically for Protanopia color vision deficiency.\n</code></pre>"},{"location":"ruff/rule_groups/Theme_Rules/#thm-002-theme-colors-deuteranopia","title":"THM-002: Theme Colors Deuteranopia","text":"<p>Applies to:</p> <ul> <li>Theme</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>All data colors should be clearly distinguishable for color vision deficiency.\nThis rule is specifically for Deuteranopia color vision deficiency.\n</code></pre>"},{"location":"ruff/rule_groups/Theme_Rules/#thm-003-theme-colors-tritanopia","title":"THM-003: Theme Colors Tritanopia","text":"<p>Applies to:</p> <ul> <li>Theme</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>All data colors should be clearly distinguishable for color vision deficiency.\nThis rule is specifically for Tritanopia color vision deficiency.\n</code></pre>"},{"location":"ruff/rule_groups/Visual_Rules/","title":"Visual Rules","text":"<p>Group of rules related to visuals.</p>"},{"location":"ruff/rule_groups/Visual_Rules/#viz-001-discourage-implicit-measures","title":"VIZ-001: Discourage Implicit Measures","text":"<p>Applies to:</p> <ul> <li>Visual</li> </ul> <p>Fix State: Not Automatically Fixable</p> <pre><code>Using implicit measures (e.g., SUM(Column)) in visuals can lead to performance issues and unexpected results. It's recommended to create explicit measures in the model for better control and optimization.\n</code></pre>"}]}